<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Photography Management System - July 24 2025 - v3.0 - Website Builder</title>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Confetti Animation Styles -->
    <style>
        .confetti-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
            overflow: hidden;
        }
        
        .confetti-piece {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #d4af37;
            animation: confetti-fall 3s linear forwards;
        }
        
        .confetti-piece:nth-child(odd) {
            background: #f4e4bc;
            border-radius: 50%;
        }
        
        .confetti-piece:nth-child(3n) {
            background: #b8941f;
            width: 8px;
            height: 8px;
        }
        
        .confetti-piece:nth-child(4n) {
            background: #efd971;
            border-radius: 2px;
        }
        
        .confetti-piece:nth-child(5n) {
            background: #c4962d;
            width: 12px;
            height: 6px;
            border-radius: 6px;
        }
        
        @keyframes confetti-fall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
        
        .milestone-toast {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #d4af37 0%, #f4e4bc 100%);
            color: #1a1a1a;
            padding: 20px 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(212, 175, 55, 0.3);
            font-size: 1.2rem;
            font-weight: 600;
            z-index: 10000;
            animation: milestone-pop 2s ease-out forwards;
            pointer-events: none;
        }
        
        @keyframes milestone-pop {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.5);
            }
            20% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1.1);
            }
            40% {
                transform: translate(-50%, -50%) scale(1);
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(1);
            }
        }
    </style>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #f5f5f5;
            background: linear-gradient(135deg, #0f0f0f 0%, #1a1a1a 50%, #2d2d2d 100%);
            min-height: 100vh;
            font-weight: 400;
            letter-spacing: 0.01em;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            color: #d4af37;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .header h1 {
            font-weight: 600;
            font-size: 2.2rem;
            letter-spacing: -0.02em;
            margin-bottom: 5px;
        }
        
        .header p {
            font-weight: 300;
            font-size: 1.1rem;
            opacity: 0.9;
            letter-spacing: 0.01em;
        }
        
        .user-info {
            background: rgba(212, 175, 55, 0.1);
            padding: 12px 24px;
            border-radius: 30px;
            backdrop-filter: blur(20px);
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 0.9rem;
            border: 1px solid rgba(212, 175, 55, 0.3);
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.1);
            color: #d4af37;
        }
        
        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            object-fit: cover;
        }
        
        .logout-btn {
            background: rgba(212, 175, 55, 0.1);
            color: #d4af37;
            border: 1px solid rgba(212, 175, 55, 0.3);
            padding: 10px 20px;
            border-radius: 25px;
            text-decoration: none;
            font-size: 0.85rem;
            transition: all 0.3s ease;
            font-weight: 500;
            backdrop-filter: blur(10px);
        }
        
        .logout-btn:hover {
            background: rgba(212, 175, 55, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(212, 175, 55, 0.3);
        }
        
        .session-form {
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(20px);
            padding: 35px;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(212, 175, 55, 0.15);
            margin-bottom: 30px;
            border: 1px solid rgba(212, 175, 55, 0.3);
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        label {
            font-weight: 500;
            margin-bottom: 8px;
            color: #d4af37;
            font-size: 0.95rem;
            letter-spacing: 0.01em;
        }
        
        input, textarea, select {
            padding: 14px 16px;
            border: 1.5px solid rgba(212, 175, 55, 0.3);
            border-radius: 10px;
            font-size: 15px;
            transition: all 0.3s ease;
            background: rgba(0, 0, 0, 0.6);
            color: #f5f5f5;
            font-weight: 400;
            letter-spacing: 0.01em;
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #d4af37;
            box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.2);
            background: rgba(0, 0, 0, 0.8);
        }
        
        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 10px;
            font-size: 15px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
            letter-spacing: 0.01em;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #d4af37 0%, #f4e4bc 100%);
            color: #1a1a1a;
            font-weight: 600;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, #f4e4bc 0%, #d4af37 100%);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(212, 175, 55, 0.4);
        }
        
        .btn-secondary {
            background: rgba(0, 0, 0, 0.8);
            color: #d4af37;
            border: 1px solid rgba(212, 175, 55, 0.4);
        }
        
        .btn-secondary:hover {
            background: rgba(212, 175, 55, 0.1);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(212, 175, 55, 0.2);
        }
        
        .btn-danger {
            background: rgba(0, 0, 0, 0.7);
            color: #ff6b6b;
            border: 1px solid rgba(255, 107, 107, 0.4);
        }
        
        .btn-danger:hover {
            background: rgba(255, 107, 107, 0.1);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.2);
        }
        
        .btn-edit, .btn-calendar, .btn-gallery-ready, .btn-invoice, 
        .btn-call, .btn-text, .btn-gallery, .btn-email,
        .btn-warning, .btn-contract, .btn-success {
            background: rgba(0, 0, 0, 0.8);
            color: #d4af37;
            border: 1px solid rgba(212, 175, 55, 0.4);
            font-weight: 500;
            font-size: 0.9rem;
            letter-spacing: 0.01em;
            text-align: center;
            backdrop-filter: blur(10px);
        }
        
        .btn-edit:hover, .btn-calendar:hover, .btn-gallery-ready:hover, 
        .btn-invoice:hover, .btn-call:hover, .btn-text:hover, 
        .btn-gallery:hover, .btn-email:hover,
        .btn-warning:hover, .btn-contract:hover, .btn-success:hover {
            background: rgba(212, 175, 55, 0.15);
            color: #f4e4bc;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(212, 175, 55, 0.3);
            border-color: rgba(212, 175, 55, 0.6);
        }
        
        .sessions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
        }
        
        .session-card {
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(212, 175, 55, 0.1);
            transition: all 0.3s ease;
            border: 1px solid rgba(212, 175, 55, 0.2);
        }
        
        .session-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(212, 175, 55, 0.2);
            border-color: rgba(212, 175, 55, 0.4);
        }
        
        .session-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .session-title {
            font-size: 1.4em;
            font-weight: 600;
            color: #d4af37;
            letter-spacing: -0.01em;
        }
        
        .session-type {
            background: linear-gradient(135deg, #d4af37 0%, #f4e4bc 100%);
            color: #1a1a1a;
            padding: 6px 16px;
            border-radius: 25px;
            font-size: 0.85em;
            font-weight: 600;
            letter-spacing: 0.02em;
        }
        
        .session-details {
            margin-bottom: 20px;
        }
        
        .detail-row {
            display: flex;
            margin-bottom: 8px;
            font-size: 0.95em;
        }
        
        .detail-label {
            font-weight: 500;
            width: 90px;
            color: #d4af37;
            font-size: 0.9em;
        }
        
        .detail-value {
            color: #f5f5f5;
            font-weight: 400;
        }
        
        .session-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 8px;
            margin-top: 15px;
        }
        
        @media (max-width: 768px) {
            .session-actions {
                grid-template-columns: 1fr;
            }
        }
        
        .photo-gallery {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(212, 175, 55, 0.3);
        }
        
        .photo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }
        
        .photo-item {
            aspect-ratio: 1;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.3s;
        }
        
        .photo-item:hover {
            transform: scale(1.05);
        }
        
        .photo-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .upload-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .upload-modal.active {
            display: flex;
        }
        
        .upload-content {
            background: rgba(0, 0, 0, 0.9);
            padding: 30px;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            border: 1px solid rgba(212, 175, 55, 0.3);
            color: #f5f5f5;
        }
        
        .upload-area {
            border: 3px dashed rgba(212, 175, 55, 0.4);
            border-radius: 12px;
            padding: 40px;
            text-align: center;
            margin: 20px 0;
            cursor: pointer;
            transition: all 0.3s;
            background: rgba(0, 0, 0, 0.6);
            color: #f5f5f5;
        }
        
        .upload-area:hover, .upload-area.dragover {
            border-color: #d4af37;
            background: rgba(212, 175, 55, 0.1);
        }
        
        .photo-count {
            background: linear-gradient(135deg, #d4af37 0%, #f4e4bc 100%);
            color: #1a1a1a;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            margin-left: 10px;
            font-weight: 600;
        }
        
        .empty-state {
            text-align: center;
            padding: 50px;
            color: #f5f5f5;
        }
        
        .progress-bar-container {
            background: rgba(0, 0, 0, 0.6);
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: 10px;
            height: 20px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-bar {
            background: linear-gradient(90deg, #d4af37, #f4e4bc);
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 10px;
        }
        
        .upload-status-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .file-preview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }
        
        .file-preview-item {
            position: relative;
            aspect-ratio: 1;
            border-radius: 8px;
            overflow: hidden;
            border: 2px solid #e2e8f0;
        }
        
        .file-preview-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .file-preview-remove {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #e53e3e;
            color: white;
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .file-progress-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
            padding: 8px;
            background: #f7fafc;
            border-radius: 6px;
        }
        
        .file-progress-name {
            flex: 1;
            font-size: 0.9em;
            color: #4a5568;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .file-progress-bar {
            background: #e2e8f0;
            border-radius: 6px;
            height: 6px;
            width: 100px;
            overflow: hidden;
        }
        
        .file-progress-fill {
            background: #48bb78;
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .file-progress-status {
            font-size: 0.8em;
            color: #48bb78;
            font-weight: 600;
            min-width: 60px;
            text-align: right;
        }
        
        .admin-checkboxes {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .admin-checkboxes h3 {
            margin: 0 0 15px 0;
            color: #2d3748;
            font-size: 1.1em;
            font-weight: 600;
        }
        
        .checkbox-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 12px;
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .checkbox-group input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: #667eea;
            cursor: pointer;
        }
        
        .checkbox-group label {
            cursor: pointer;
        }
        
        .upload-limits-info {
            background: #e6fffa;
            border: 1px solid #81e6d9;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            color: #234e52;
        }
        
        .upload-limits-info h4 {
            margin: 0 0 8px 0;
            color: #065f46;
        }
        
        .upload-limits-info ul {
            margin: 0;
            padding-left: 20px;
        }
        
        .batch-upload-info {
            background: #fef7e0;
            border: 1px solid #f6cc73;
            border-radius: 8px;
            padding: 12px;
            margin: 10px 0;
            color: #744210;
            font-size: 0.9rem;
        }
        
        /* Payment Plan Styles */
        .payment-plan-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .payment-plan-modal.active {
            display: flex;
        }
        
        .payment-plan-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .payment-plan-form {
            display: grid;
            gap: 20px;
        }
        
        .payment-plan-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .payment-plan-summary {
            background: #f7fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .payment-plan-summary h4 {
            margin: 0 0 15px 0;
            color: #2d3748;
        }
        
        .payment-schedule {
            margin: 15px 0;
        }
        
        .payment-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 15px;
            margin: 5px 0;
            background: white;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        
        .payment-status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
        }
        
        .payment-status.pending {
            background: #fef7e0;
            color: #744210;
        }
        
        .payment-status.paid {
            background: #dcfce7;
            color: #166534;
        }
        
        .payment-status.overdue {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .payment-plan-info {
            background: #e6fffa;
            border: 1px solid #81e6d9;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            color: #234e52;
        }
        
        .payment-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        /* Navigation Tabs */
        .nav-tabs {
            display: flex;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(20px);
            border-radius: 16px;
            padding: 10px;
            margin: 25px 0;
            box-shadow: 0 10px 30px rgba(212, 175, 55, 0.1);
            gap: 6px;
            border: 1px solid rgba(212, 175, 55, 0.3);
        }

        .nav-tab {
            flex: 1;
            padding: 16px 24px;
            border: none;
            border-radius: 12px;
            background: transparent;
            color: #f5f5f5;
            font-weight: 500;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s ease;
            letter-spacing: 0.01em;
        }

        .nav-tab:hover {
            background: rgba(212, 175, 55, 0.1);
            color: #d4af37;
            transform: translateY(-1px);
        }

        .nav-tab.active {
            background: linear-gradient(135deg, #d4af37 0%, #f4e4bc 100%);
            color: #1a1a1a;
            font-weight: 600;
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(212, 175, 55, 0.3);
        }

        /* Tab Content Areas */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Website Builder Styles */
        .website-builder-container {
            max-width: 100%;
            margin: 0;
        }

        .builder-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .builder-header h2 {
            color: #d4af37;
            margin-bottom: 8px;
        }

        .builder-header p {
            color: #f5f5f5;
            font-size: 1.1rem;
        }

        .website-toolbar {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.6);
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(212, 175, 55, 0.1);
            border: 1px solid rgba(212, 175, 55, 0.2);
            flex-wrap: wrap;
        }

        .builder-interface {
            display: grid;
            grid-template-columns: 250px 1fr 300px;
            gap: 20px;
            min-height: 800px;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(212, 175, 55, 0.1);
        }

        /* Left Sidebar - Components */
        .builder-sidebar {
            background: rgba(0, 0, 0, 0.8);
            padding: 20px;
            border-right: 1px solid rgba(212, 175, 55, 0.2);
            overflow-y: auto;
        }

        .builder-sidebar h3 {
            color: #d4af37;
            margin-bottom: 20px;
            font-size: 1.2rem;
        }

        .component-category {
            margin-bottom: 25px;
        }

        .component-category h4 {
            color: #d4af37;
            font-size: 0.9rem;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .component-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .component-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: rgba(0, 0, 0, 0.6);
            border-radius: 8px;
            cursor: grab;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            color: #f5f5f5;
        }

        .component-item:hover {
            background: rgba(212, 175, 55, 0.1);
            border-color: #d4af37;
            transform: translateX(5px);
            color: #d4af37;
        }

        .component-item:active {
            cursor: grabbing;
        }

        .component-icon {
            font-size: 1.2rem;
            width: 24px;
            text-align: center;
        }

        .component-item span {
            font-weight: 500;
            color: #2d3748;
        }

        /* Center Canvas */
        .builder-canvas {
            background: white;
            display: flex;
            flex-direction: column;
        }

        .canvas-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid #e2e8f0;
            background: #f8fafc;
        }

        .canvas-header h3 {
            color: #2d3748;
            margin: 0;
        }

        .canvas-controls {
            display: flex;
            gap: 8px;
        }

        .canvas-control {
            padding: 8px 16px;
            border: 1px solid #e2e8f0;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .canvas-control:hover,
        .canvas-control.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .canvas-viewport {
            flex: 1;
            padding: 20px;
            background: #e2e8f0;
            overflow: auto;
        }

        .website-canvas {
            background: white;
            min-height: 600px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            position: relative;
            margin: 0 auto;
            transition: all 0.3s ease;
        }

        .website-canvas.desktop {
            max-width: 1200px;
        }

        .website-canvas.tablet {
            max-width: 768px;
        }

        .website-canvas.mobile {
            max-width: 375px;
        }

        .drop-zone {
            min-height: 600px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 3px dashed #cbd5e0;
            border-radius: 8px;
            margin: 20px;
            transition: all 0.3s ease;
        }

        .drop-zone.drag-over {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .drop-zone-message {
            text-align: center;
            color: #666;
        }

        .drop-zone-message h3 {
            margin-bottom: 12px;
            color: #2d3748;
        }

        .drop-zone-message p {
            margin-bottom: 25px;
            font-size: 1.1rem;
        }

        .quick-start-templates {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .template-btn {
            padding: 12px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .template-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .template-btn.legacy-style {
            background: linear-gradient(135deg, #1a1a1a 0%, #333 100%);
            border: 2px solid #d4af37;
        }

        .template-btn.modern-style {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .template-btn.elegant-style {
            background: linear-gradient(135deg, #2c1810 0%, #8b4513 100%);
            border: 2px solid #ddd6c1;
        }

        /* Right Sidebar - Properties */
        .builder-properties {
            background: white;
            padding: 20px;
            border-left: 1px solid #e2e8f0;
            overflow-y: auto;
        }

        .builder-properties h3 {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 1.2rem;
        }

        .no-selection {
            text-align: center;
            color: #666;
            padding: 40px 20px;
        }

        /* Website List */
        .websites-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .website-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .website-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.15);
        }

        .website-preview {
            width: 100%;
            height: 200px;
            background: #f8fafc;
            border-radius: 8px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            font-size: 2rem;
        }

        .website-info h4 {
            margin: 0 0 8px 0;
            color: #2d3748;
        }

        .website-info p {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        .website-actions {
            display: flex;
            gap: 10px;
        }

        .website-actions .btn {
            flex: 1;
            padding: 8px 12px;
            font-size: 0.9rem;
        }

        /* Component Wrapper Styles */
        .component-wrapper {
            position: relative;
            margin-bottom: 2px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .component-wrapper:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        /* Gallery hover effects */
        .component-wrapper:hover [style*="aspect-ratio"] > [style*="position: absolute"] {
            transform: translateY(0) !important;
        }

        .component-wrapper:hover [style*="aspect-ratio"]:hover {
            transform: scale(1.05);
        }

        .component-wrapper:hover [style*="opacity: 0"]:hover {
            opacity: 1 !important;
        }

        /* Properties Panel Styles */
        .property-section {
            padding: 15px 0;
        }

        .property-section h4 {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 1.1rem;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 10px;
        }

        .property-group {
            margin-bottom: 20px;
        }

        .property-group label {
            display: block;
            color: #4a5568;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .property-group input[type="color"] {
            width: 100%;
            height: 40px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            cursor: pointer;
        }

        .property-group input[type="range"] {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: #e2e8f0;
            outline: none;
            cursor: pointer;
        }

        .property-group input[type="range"]::-webkit-slider-thumb {
            appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
        }

        .property-group input[type="range"]::-moz-range-thumb {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            border: none;
        }

        .property-actions {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #e2e8f0;
        }

        .property-actions .btn {
            width: 100%;
            justify-content: center;
        }

        /* Template Loading Animation */
        .template-loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
            z-index: 1000;
            text-align: center;
        }

        .template-loading h3 {
            margin-bottom: 15px;
            color: #2d3748;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #e2e8f0;
            border-left: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .builder-interface {
                grid-template-columns: 200px 1fr 250px;
            }
        }

        @media (max-width: 768px) {
            .builder-interface {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto 1fr auto;
                height: auto;
                min-height: 100vh;
            }
            
            .builder-sidebar,
            .builder-properties {
                max-height: 250px;
                overflow-y: auto;
                position: relative;
                z-index: 10;
            }
            
            .builder-sidebar {
                order: 1;
                background: #f8fafc;
                border-bottom: 1px solid #e2e8f0;
                padding: 15px;
            }
            
            .builder-canvas {
                order: 2;
                padding: 10px;
                min-height: 400px;
            }
            
            .builder-properties {
                order: 3;
                background: #f8fafc;
                border-top: 1px solid #e2e8f0;
                padding: 15px;
            }
            
            .website-toolbar {
                justify-content: center;
                flex-wrap: wrap;
                gap: 10px;
                padding: 10px;
            }
            
            .canvas-controls {
                flex-wrap: wrap;
                justify-content: center;
                gap: 8px;
            }
            
            .canvas-control {
                padding: 8px 15px;
                font-size: 0.9rem;
            }

            .quick-start-templates {
                flex-direction: column;
                align-items: center;
                gap: 10px;
            }

            .template-btn {
                width: 200px;
                padding: 12px 20px;
                font-size: 0.9rem;
            }
            
            .component-library h4,
            .builder-properties h3 {
                font-size: 1.1rem;
                margin-bottom: 15px;
            }
            
            .component-category {
                margin-bottom: 20px;
            }
            
            .component-item {
                padding: 12px;
                font-size: 0.9rem;
            }
            
            .website-canvas {
                min-height: 300px;
                border-radius: 8px;
            }
            
            .website-canvas.mobile {
                max-width: 375px;
                margin: 0 auto;
            }
            
            .website-canvas.tablet {
                max-width: 768px;
                margin: 0 auto;
            }
            
            .drop-zone {
                min-height: 300px;
            }
            
            .drop-zone-message h3 {
                font-size: 1.5rem;
            }
            
            .drop-zone-message p {
                font-size: 1rem;
            }
            
            /* Mobile-friendly component editing */
            .component-wrapper {
                outline: none !important;
                border: 2px solid transparent;
                margin-bottom: 1px;
                position: relative;
            }
            
            .component-wrapper.selected {
                border-color: #667eea !important;
                background: rgba(102, 126, 234, 0.05);
            }
            
            .component-wrapper::after {
                content: 'âœŽ Tap to Edit';
                position: absolute;
                top: 5px;
                right: 5px;
                background: rgba(102, 126, 234, 0.9);
                color: white;
                padding: 2px 6px;
                border-radius: 4px;
                font-size: 0.7rem;
                opacity: 0;
                transition: opacity 0.3s;
                pointer-events: none;
            }
            
            .component-wrapper:hover::after,
            .component-wrapper.selected::after {
                opacity: 1;
            }
        }
        
        @media (max-width: 480px) {
            .builder-sidebar,
            .builder-properties {
                max-height: 200px;
            }
            
            .website-toolbar {
                padding: 8px;
            }
            
            .canvas-control {
                padding: 6px 12px;
                font-size: 0.8rem;
            }
            
            .template-btn {
                width: 180px;
                padding: 10px 15px;
                font-size: 0.8rem;
            }
            
            .component-item {
                padding: 10px;
                font-size: 0.8rem;
            }
        }

        /* Revolutionary Website Builder Styles */
        .revolutionary-website-builder {
            padding: 0;
            width: 100%;
            height: calc(100vh - 120px);
            overflow: hidden;
        }

        .builder-mode-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background: white;
            border-bottom: 1px solid #e2e8f0;
        }

        .builder-mode-switch {
            display: flex;
            gap: 5px;
            background: #f8f9fa;
            padding: 4px;
            border-radius: 10px;
        }

        .mode-btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            background: transparent;
            color: #666;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .mode-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .builder-actions {
            display: flex;
            gap: 10px;
        }

        .action-btn {
            padding: 10px 20px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .action-btn.primary {
            background: #667eea;
            color: white;
        }

        .action-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        /* Template Gallery Mode */
        .template-gallery-mode {
            display: none;
            padding: 40px 20px;
            height: calc(100vh - 200px);
            overflow-y: auto;
        }

        .template-gallery-mode.active {
            display: block;
        }

        .template-hero {
            text-align: center;
            margin-bottom: 40px;
        }

        .template-hero h2 {
            font-size: 2.5rem;
            color: #2d3748;
            margin-bottom: 10px;
        }

        .template-hero p {
            font-size: 1.2rem;
            color: #666;
        }

        .template-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .template-card {
            background: white;
            border-radius: 16px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .template-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }

        .template-preview {
            height: 250px;
            position: relative;
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .legacy-preview {
            background: linear-gradient(135deg, #1a1a1a 0%, #8b7355 100%);
            color: #d4af37;
        }

        .modern-preview {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .elegant-preview {
            background: linear-gradient(135deg, #8B4513 0%, #D2B48C 100%);
            color: #FDF5E6;
        }

        .legacy-elite-preview {
            background: linear-gradient(135deg, #0f0f0f 0%, #1a1a1a 50%, #2c1810 100%);
            color: #d4af37;
            position: relative;
            overflow: hidden;
        }

        .legacy-elite-preview::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 30% 30%, rgba(212, 175, 55, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        .legacy-elite-preview .preview-tagline {
            font-size: 0.9rem;
            font-style: italic;
            color: rgba(212, 175, 55, 0.8);
            text-align: center;
            margin: 10px 0;
        }

        .legacy-photo-1 {
            background: linear-gradient(45deg, #8b7355, #d4af37);
            position: relative;
        }

        .legacy-photo-2 {
            background: linear-gradient(45deg, #2c1810, #8b7355);
        }

        .legacy-photo-3 {
            background: linear-gradient(45deg, #d4af37, #f4e4bc);
        }

        .legacy-elite-btn {
            background: linear-gradient(135deg, #d4af37 0%, #f4e4bc 100%) !important;
            color: #1a1a1a !important;
            font-weight: 700 !important;
            text-shadow: none !important;
        }

        .legacy-elite-btn:hover {
            transform: translateY(-3px) !important;
            box-shadow: 0 12px 28px rgba(212, 175, 55, 0.4) !important;
        }

        .preview-header {
            font-size: 1.2rem;
            font-weight: 600;
            text-align: center;
        }

        .preview-hero {
            font-size: 2rem;
            font-weight: 300;
            text-align: center;
            margin: 20px 0;
        }

        .preview-gallery {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-top: auto;
        }

        .preview-photo {
            aspect-ratio: 1;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
        }

        .template-info {
            padding: 25px;
        }

        .template-info h3 {
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 10px;
            color: #2d3748;
        }

        .template-info p {
            color: #666;
            line-height: 1.5;
            margin-bottom: 15px;
        }

        .template-features {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
        }

        .feature-tag {
            background: #f1f3f4;
            color: #5f6368;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .use-template-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 14px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            width: 100%;
            transition: all 0.3s ease;
        }

        .use-template-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }

        /* Custom Builder Mode */
        .custom-builder-mode {
            display: none;
            height: calc(100vh - 200px);
        }

        .custom-builder-mode.active {
            display: block;
        }

        .builder-interface {
            display: grid;
            grid-template-columns: 300px 1fr 280px;
            height: 100%;
            background: #f8fafc;
        }

        .builder-sidebar {
            background: white;
            padding: 20px;
            overflow-y: auto;
            border-right: 1px solid #e2e8f0;
        }

        .ai-section, .branding-section, .component-section {
            margin-bottom: 30px;
        }

        .ai-section h3, .branding-section h3, .component-section h3 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .ai-btn {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 6px;
            cursor: pointer;
            width: 100%;
            margin-bottom: 8px;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .ai-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.3);
        }

        .branding-control {
            margin-bottom: 15px;
        }

        .branding-control label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            font-size: 0.9rem;
            color: #4a5568;
        }

        .logo-upload, .brand-input, .font-select {
            width: 100%;
            padding: 8px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            font-size: 0.9rem;
        }

        .logo-preview {
            margin-top: 8px;
            text-align: center;
            min-height: 40px;
        }

        .color-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .color-input-group {
            text-align: center;
        }

        .color-input-group label {
            font-size: 0.8rem;
            color: #666;
            margin-bottom: 4px;
        }

        .color-input {
            width: 100%;
            height: 35px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .component-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
        }

        .component-item {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px;
            border-radius: 8px;
            cursor: grab;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .component-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(102, 126, 234, 0.4);
        }

        .component-item:active {
            cursor: grabbing;
        }

        .builder-canvas {
            display: flex;
            flex-direction: column;
            background: #f8fafc;
        }

        .canvas-controls {
            padding: 15px 20px;
            background: white;
            border-bottom: 1px solid #e2e8f0;
        }

        .device-controls {
            display: flex;
            gap: 8px;
        }

        .device-btn {
            padding: 8px 16px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .device-btn.active {
            background: #667eea;
            color: white;
        }

        .website-canvas {
            flex: 1;
            position: relative;
            overflow: auto;
            background: white;
            margin: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .website-content {
            min-height: 100%;
            position: relative;
        }

        .canvas-placeholder {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 400px;
            color: #666;
            text-align: center;
        }

        .canvas-placeholder h2 {
            margin-bottom: 10px;
            color: #4a5568;
        }

        .smart-guides {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 1000;
        }

        .builder-properties {
            background: white;
            padding: 20px;
            overflow-y: auto;
            border-left: 1px solid #e2e8f0;
        }

        .builder-properties h3 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .property-panel .no-selection {
            text-align: center;
            color: #666;
            padding: 40px 20px;
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .builder-interface {
                grid-template-columns: 250px 1fr 250px;
            }
        }

        @media (max-width: 768px) {
            .builder-interface {
                grid-template-columns: 1fr;
                grid-template-rows: auto 1fr;
            }
            
            .builder-sidebar,
            .builder-properties {
                max-height: 200px;
            }
            
            .template-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .builder-header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .builder-header h2 {
            color: #2d3748;
            margin: 0 0 10px 0;
            font-size: 2.5rem;
        }
        
        .builder-header p {
            color: #4a5568;
            font-size: 1.2rem;
        }
        
        /* Template Selection Styles */
        .template-selection {
            margin-bottom: 40px;
        }
        
        .template-selection h3 {
            text-align: center;
            color: #2d3748;
            margin-bottom: 30px;
            font-size: 1.8rem;
        }
        
        .photography-templates {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .template-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            border: 2px solid #e2e8f0;
            transition: all 0.3s;
            cursor: pointer;
            text-align: center;
        }
        
        .template-card:hover {
            border-color: #667eea;
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .template-preview {
            margin-bottom: 20px;
            height: 200px;
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid #e2e8f0;
        }
        
        .template-mockup {
            height: 100%;
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            font-size: 0.8rem;
        }
        
        /* Template Mockup Styles */
        .legacy-mockup {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            color: #D4AF37;
        }
        
        .modern-mockup {
            background: linear-gradient(135deg, #f8fafc 0%, #ffffff 100%);
            color: #2d3748;
            border: 1px solid #e2e8f0;
        }
        
        .romantic-mockup {
            background: linear-gradient(135deg, #fdf7f0 0%, #f7e6d7 100%);
            color: #8b5a3c;
        }
        
        .bold-mockup {
            background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%);
            color: #ffffff;
        }
        
        .mockup-header {
            font-weight: bold;
            font-size: 0.9rem;
            text-align: center;
            border-bottom: 1px solid currentColor;
            padding-bottom: 5px;
        }
        
        .mockup-hero {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            font-weight: 600;
        }
        
        .mockup-gallery {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 5px;
            height: 40px;
        }
        
        .mockup-photo {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
        }
        
        .template-card h4 {
            color: #2d3748;
            margin: 0 0 10px 0;
            font-size: 1.3rem;
        }
        
        .template-card p {
            color: #4a5568;
            margin: 0 0 20px 0;
            line-height: 1.5;
        }
        
        /* Website Customization Interface */
        .website-customization {
            background: white;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
            margin-top: 20px;
        }
        
        .customization-header {
            padding: 20px;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .customization-header h3 {
            color: #2d3748;
            margin: 0;
            font-size: 1.5rem;
        }
        
        .website-actions {
            display: flex;
            gap: 10px;
        }
        
        .customization-interface {
            display: grid;
            grid-template-columns: 350px 1fr;
            min-height: 600px;
        }
        
        /* Customization Panel */
        .customization-panel {
            background: #f8fafc;
            border-right: 1px solid #e2e8f0;
            display: flex;
            flex-direction: column;
        }
        
        .customization-tabs {
            display: flex;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .customization-tab {
            flex: 1;
            padding: 15px 10px;
            border: none;
            background: none;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            color: #4a5568;
            transition: all 0.2s;
        }
        
        .customization-tab.active {
            background: white;
            color: #667eea;
            border-bottom: 2px solid #667eea;
        }
        
        .customization-tab:hover:not(.active) {
            background: #f1f5f9;
        }
        
        .customization-section {
            padding: 20px;
            display: none;
            overflow-y: auto;
            flex: 1;
        }
        
        .customization-section.active {
            display: block;
        }
        
        .customization-section h4 {
            margin: 0 0 20px 0;
            color: #2d3748;
            font-size: 1.2rem;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #2d3748;
        }
        
        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            font-size: 0.9rem;
            transition: border-color 0.2s;
        }
        
        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .form-group input[type="color"] {
            height: 45px;
            padding: 5px;
            cursor: pointer;
        }
        
        .form-group small {
            display: block;
            margin-top: 5px;
            color: #6b7280;
            font-size: 0.8rem;
        }
        
        .photo-upload-section {
            margin-top: 20px;
            padding: 20px;
            border: 2px dashed #cbd5e0;
            border-radius: 8px;
            text-align: center;
        }
        
        .photo-preview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }
        
        .photo-preview-item {
            aspect-ratio: 1;
            background: #f1f5f9;
            border-radius: 6px;
            overflow: hidden;
            position: relative;
        }
        
        .photo-preview-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        /* Live Preview */
        .website-preview {
            background: white;
            display: flex;
            flex-direction: column;
        }
        
        .preview-header {
            padding: 15px 20px;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .preview-header h4 {
            margin: 0;
            color: #2d3748;
        }
        
        .preview-controls {
            display: flex;
            gap: 8px;
        }
        
        .preview-control {
            padding: 8px 12px;
            border: 1px solid #e2e8f0;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s;
        }
        
        .preview-control:hover {
            background: #f7fafc;
        }
        
        .preview-control.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        
        .website-preview-frame {
            flex: 1;
            padding: 20px;
            overflow: auto;
            background: #f8fafc;
        }
        
        .website-preview-frame.desktop {
            padding: 20px;
        }
        
        .website-preview-frame.tablet {
            padding: 20px 60px;
        }
        
        .website-preview-frame.mobile {
            padding: 20px 100px;
        }
        
        /* Mobile Responsive for Photography Builder */
        @media (max-width: 768px) {
            .photography-templates {
                grid-template-columns: 1fr;
            }
            
            .customization-interface {
                grid-template-columns: 1fr;
                grid-template-rows: auto 1fr;
            }
            
            .customization-panel {
                order: 1;
            }
            
            .website-preview {
                order: 2;
                min-height: 400px;
            }
            
            .customization-header {
                flex-direction: column;
                align-items: stretch;
                gap: 15px;
            }
            
            .website-actions {
                justify-content: center;
            }
            
            .website-preview-frame.tablet,
            .website-preview-frame.mobile {
                padding: 20px;
            }
        }
        
        @media (max-width: 768px) {
            .container { padding: 10px; }
            .sessions-grid { grid-template-columns: 1fr; }
            .form-grid { grid-template-columns: 1fr; }
            .session-actions { flex-direction: column; }
            .btn { width: 100%; margin: 2px 0; }
            .checkbox-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div>
                <h1>Photography Management System</h1>
                <p>Complete business management platform for professional photographers</p>
            </div>
            <div id="userInfo" class="user-info" style="display: none;">
                <img id="userAvatar" class="user-avatar" src="" alt="User Avatar">
                <span id="userName"></span>
                <a href="/api/logout" class="logout-btn">Sign Out</a>
            </div>
        </div>

        <!-- Navigation Tabs -->
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="switchTab('clients')">
                Client Management
            </button>
            <button class="nav-tab" onclick="switchTab('websites')">
                Website Builder
            </button>
        </div>

        <!-- Client Management Tab Content -->
        <div id="clientsTab" class="tab-content active">
        <!-- Session Form -->
        <div class="session-form">
            <h2>Add New Session</h2>
            <form id="sessionForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="clientName">Client Name</label>
                        <input type="text" id="clientName" name="clientName" required placeholder="Enter client name">
                    </div>
                    <div class="form-group">
                        <label for="sessionType">Session Type</label>
                        <input type="text" id="sessionType" name="sessionType" required placeholder="Wedding, Portrait, etc.">
                    </div>
                    <div class="form-group">
                        <label for="dateTime">Date & Time</label>
                        <input type="datetime-local" id="dateTime" name="dateTime" required min="2025-01-01T00:00">
                    </div>
                    <div class="form-group">
                        <label for="location">Location</label>
                        <input type="text" id="location" name="location" required placeholder="Session location">
                    </div>
                    <div class="form-group">
                        <label for="phoneNumber">Phone</label>
                        <input type="tel" id="phoneNumber" name="phoneNumber" required placeholder="+1 (555) 123-4567">
                    </div>
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" id="email" name="email" required placeholder="client@example.com">
                    </div>
                    <div class="form-group">
                        <label for="price">Price</label>
                        <input type="number" id="price" name="price" step="0.01" required placeholder="0.00">
                    </div>
                    <div class="form-group">
                        <label for="duration">Duration (minutes)</label>
                        <input type="number" id="duration" name="duration" required placeholder="60">
                    </div>
                </div>
                
                <!-- Admin Workflow Checkboxes -->
                <div class="admin-checkboxes">
                    <h3>Admin Workflow Status</h3>
                    <div class="checkbox-grid">
                        <div class="checkbox-group">
                            <input type="checkbox" id="contractSigned" name="contractSigned">
                            <label for="contractSigned">Contract Signed</label>
                        </div>
                        <div class="checkbox-group">
                            <input type="checkbox" id="paid" name="paid">
                            <label for="paid">Paid</label>
                        </div>
                        <div class="checkbox-group">
                            <input type="checkbox" id="edited" name="edited">
                            <label for="edited">Edited</label>
                        </div>
                        <div class="checkbox-group">
                            <input type="checkbox" id="delivered" name="delivered">
                            <label for="delivered">Delivered</label>
                        </div>
                        <div class="checkbox-group">
                            <input type="checkbox" id="sendReminder" name="sendReminder">
                            <label for="sendReminder">Send session reminder 24 hours before</label>
                        </div>
                        <div class="checkbox-group">
                            <input type="checkbox" id="notifyGalleryReady" name="notifyGalleryReady">
                            <label for="notifyGalleryReady">Notify when gallery is ready</label>
                        </div>
                    </div>
                </div>
                
                <button type="submit" class="btn btn-primary">Add Session</button>
                <button type="button" class="btn btn-secondary" onclick="celebrateMilestone('session_created', 'Test Client')" style="margin-left: 10px;">ðŸŽ‰ Test Confetti</button>
            </form>
        </div>

        <!-- Sessions Display -->
        <div id="sessionsContainer" class="sessions-grid">
            <div class="empty-state">
                <h3>No sessions yet</h3>
                <p>Add your first photography session above!</p>
            </div>
        </div>
    </div>

    <!-- Upload Modal -->
    <div id="uploadModal" class="upload-modal">
        <div class="upload-content">
            <h3>Upload Photos</h3>
            
            <div class="upload-limits-info">
                <h4>ðŸ“ˆ Enhanced Upload Capacity</h4>
                <ul>
                    <li><strong>Unlimited file size</strong> - Upload RAW photos, high-res images</li>
                    <li><strong>Unlimited quantity</strong> - Upload entire photo shoots at once</li>
                    <li><strong>Batch processing</strong> - Large uploads handled automatically</li>
                    <li><strong>Progress tracking</strong> - Monitor individual file uploads</li>
                </ul>
            </div>
            
            <div class="upload-area" id="uploadArea">
                <p>Click here or drag photos to upload</p>
                <p style="font-size: 0.9em; color: #718096; margin-top: 10px;">Supports unlimited photos of any size - JPG, PNG, RAW files welcome!</p>
            </div>
            <input type="file" id="fileInput" multiple accept="image/*" style="display: none;">
            <div id="uploadProgress" style="margin: 20px 0;">
                <div id="filePreview" style="margin-bottom: 15px;"></div>
                <div id="uploadStatus" style="display: none;">
                    <div class="upload-status-header">
                        <span id="uploadStatusText">Preparing upload...</span>
                        <span id="uploadCounter">0/0</span>
                    </div>
                    <div class="progress-bar-container">
                        <div class="progress-bar" id="overallProgress"></div>
                    </div>
                    <div id="fileProgressList" style="margin-top: 15px;"></div>
                </div>
            </div>
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn btn-primary" id="uploadBtn" onclick="startUpload()" style="display: none;">Upload Selected Photos</button>
                <button class="btn btn-secondary" onclick="closeUploadModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- Payment Plan Modal -->
    <div id="paymentPlanModal" class="payment-plan-modal">
        <div class="payment-plan-content">
            <h3>Create Payment Plan</h3>
            
            <div class="payment-plan-form">
                <div class="payment-plan-grid">
                    <div class="form-group">
                        <label for="planTotalAmount">Total Amount ($)</label>
                        <input type="number" id="planTotalAmount" step="0.01" placeholder="0.00" required>
                    </div>
                    <div class="form-group">
                        <label for="planStartDate">Start Date</label>
                        <input type="date" id="planStartDate" required>
                    </div>
                    <div class="form-group">
                        <label for="planEndDate">End Date</label>
                        <input type="date" id="planEndDate" required>
                    </div>
                    <div class="form-group">
                        <label for="planReminderDays">Reminder Days Before</label>
                        <select id="planReminderDays">
                            <option value="1">1 day</option>
                            <option value="3" selected>3 days</option>
                            <option value="7">1 week</option>
                        </select>
                    </div>
                </div>
                
                <div class="payment-plan-summary" id="paymentPlanSummary" style="display: none;">
                    <h4>ðŸ“‹ Payment Plan Summary</h4>
                    <div id="paymentSummaryDetails"></div>
                    <div class="payment-schedule" id="paymentSchedulePreview"></div>
                </div>
                
                <div class="payment-plan-info">
                    <h4>â„¹ï¸ How Payment Plans Work</h4>
                    <ul>
                        <li>Automatically calculates equal monthly payments</li>
                        <li>Sends Stripe invoices each month via email</li>
                        <li>Tracks payments and sends reminders</li>
                        <li>Updates session status when fully paid</li>
                    </ul>
                </div>
                
                <div class="payment-actions">
                    <button class="btn btn-primary" id="createPaymentPlanBtn" onclick="createPaymentPlan()">Create Payment Plan</button>
                    <button class="btn btn-secondary" onclick="calculatePaymentPreview()">Preview Payments</button>
                    <button class="btn btn-secondary" onclick="closePaymentPlanModal()">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Payment Plan View Modal -->
    <div id="paymentPlanViewModal" class="payment-plan-modal">
        <div class="payment-plan-content">
            <h3 id="paymentPlanViewTitle">Payment Plan Details</h3>
            
            <div id="paymentPlanViewContent">
                <!-- Payment plan details will be loaded here -->
            </div>
            
            <div class="payment-actions">
                <button class="btn btn-primary" onclick="processAutomatedPayments()">Process All Due Payments</button>
                <button class="btn btn-secondary" onclick="closePaymentPlanViewModal()">Close</button>
            </div>
        </div>
    </div>

    <script>
        let sessions = [];
        let currentUploadSessionId = null;
        let currentPaymentPlanSessionId = null;

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            loadSessions();
            setupEventListeners();
        });

        function setupEventListeners() {
            document.getElementById('sessionForm').addEventListener('submit', addSession);
            
            const uploadArea = document.getElementById('uploadArea');
            const fileInput = document.getElementById('fileInput');
            
            uploadArea.addEventListener('click', () => fileInput.click());
            uploadArea.addEventListener('dragover', handleDragOver);
            uploadArea.addEventListener('drop', handleDrop);
            fileInput.addEventListener('change', handleFileSelect);
        }

        async function addSession(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const sessionData = {
                clientName: formData.get('clientName'),
                sessionType: formData.get('sessionType'),
                dateTime: formData.get('dateTime'),
                location: formData.get('location'),
                phoneNumber: formData.get('phoneNumber'),
                email: formData.get('email'),
                price: parseFloat(formData.get('price')),
                duration: parseInt(formData.get('duration')),
                contractSigned: formData.get('contractSigned') === 'on',
                paid: formData.get('paid') === 'on',
                edited: formData.get('edited') === 'on',
                delivered: formData.get('delivered') === 'on',
                sendReminder: formData.get('sendReminder') === 'on',
                notifyGalleryReady: formData.get('notifyGalleryReady') === 'on',
                photos: []
            };

            try {
                if (editingSessionId) {
                    // Update existing session
                    const response = await fetch(`/api/sessions/${editingSessionId}`, {
                        method: 'PUT',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(sessionData)
                    });
                    
                    if (response.ok) {
                        const updatedSession = await response.json();
                        const sessionIndex = sessions.findIndex(s => s.id === editingSessionId);
                        if (sessionIndex !== -1) {
                            sessions[sessionIndex] = updatedSession;
                        }
                        renderSessions();
                        resetForm(e.target);
                        showMessage('Session updated successfully!', 'success');
                    } else {
                        showMessage('Failed to update session', 'error');
                    }
                } else {
                    // Create new session
                    const response = await fetch('/api/sessions', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(sessionData)
                    });
                    
                    if (response.ok) {
                        const newSession = await response.json();
                        sessions.unshift(newSession);
                        renderSessions();
                        resetForm(e.target);
                        showMessage('Session added successfully!', 'success');
                        
                        // Trigger milestone celebration for new session
                        celebrateMilestone('session_created', newSession.clientName);
                    } else {
                        showMessage('Failed to add session', 'error');
                    }
                }
            } catch (error) {
                console.error('Error processing session:', error);
                showMessage('Error processing session', 'error');
            }
        }

        function resetForm(form) {
            form.reset();
            editingSessionId = null;
            const submitBtn = form.querySelector('button[type="submit"]');
            submitBtn.textContent = 'Add Session';
        }

        async function loadSessions() {
            try {
                const response = await fetch('/api/sessions');
                if (response.ok) {
                    sessions = await response.json();
                    renderSessions();
                }
            } catch (error) {
                console.error('Error loading sessions:', error);
            }
        }

        function renderSessions() {
            const container = document.getElementById('sessionsContainer');
            
            if (sessions.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <h3>No sessions yet</h3>
                        <p>Add your first photography session above!</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = sessions.map(session => `
                <div class="session-card">
                    <div class="session-header">
                        <div class="session-title">${session.clientName}</div>
                        <div class="session-type">${session.sessionType}</div>
                    </div>
                    
                    <div class="session-details">
                        <div class="detail-row">
                            <span class="detail-label">Date:</span>
                            <span class="detail-value">${formatDateTime(session.dateTime)}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Location:</span>
                            <span class="detail-value">${session.location}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Phone:</span>
                            <span class="detail-value">${session.phoneNumber}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Price:</span>
                            <span class="detail-value">$${session.price}</span>
                        </div>
                        ${session.hasPaymentPlan ? `
                            <div class="detail-row">
                                <span class="detail-label">Payment Plan:</span>
                                <span class="detail-value">$${session.monthlyPayment}/month (${session.paymentsRemaining || 0} remaining)</span>
                            </div>
                        ` : ''}
                    </div>

                    <div class="session-actions">
                        <button class="btn btn-edit" onclick="editSession('${session.id}')">
                            Edit
                        </button>
                        <button class="btn btn-secondary" onclick="openUploadModal('${session.id}')">
                            Upload Photos${session.photos && session.photos.length ? ` (${session.photos.length})` : ''}
                        </button>
                        <button class="btn btn-calendar" onclick="addToCalendar('${session.id}')">
                            Add to Calendar
                        </button>
                        <button class="btn btn-primary" onclick="openEmailClient('${session.id}')">
                            Email Client
                        </button>
                        <button class="btn btn-warning" onclick="copyGalleryUrl('${session.id}')">
                            Copy Gallery URL
                        </button>
                        <button class="btn btn-contract" onclick="openContractModal('${session.id}')">
                            Send Contract
                        </button>
                        ${session.hasPaymentPlan ? `
                            <button class="btn btn-success" onclick="viewPaymentPlan('${session.id}')">
                                View Payment Plan
                            </button>
                        ` : `
                            <button class="btn btn-invoice" onclick="sendInvoice('${session.id}')">
                                Send Invoice
                            </button>
                            <button class="btn btn-invoice" onclick="sendDepositInvoice('${session.id}')">
                                Send Deposit
                            </button>
                            <button class="btn btn-success" onclick="openPaymentPlanModal('${session.id}')">
                                Create Payment Plan
                            </button>
                        `}
                        <button class="btn btn-call" onclick="callClient('${session.phoneNumber}')">
                            Call Client
                        </button>
                        <button class="btn btn-text" onclick="textClient('${session.phoneNumber}', '${session.clientName}', '${session.id}')">
                            Text Client
                        </button>
                        <button class="btn btn-danger" onclick="deleteSession('${session.id}')">
                            Delete
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function openUploadModal(sessionId) {
            currentUploadSessionId = sessionId;
            document.getElementById('uploadModal').classList.add('active');
        }

        function closeUploadModal() {
            document.getElementById('uploadModal').classList.remove('active');
            currentUploadSessionId = null;
            selectedFiles = [];
            
            // Reset all upload interface elements
            document.getElementById('filePreview').innerHTML = '';
            document.getElementById('uploadStatus').style.display = 'none';
            document.getElementById('uploadBtn').style.display = 'none';
            document.getElementById('fileInput').value = '';
            
            // Clear any existing progress intervals
            if (window.uploadProgressIntervals) {
                window.uploadProgressIntervals.forEach(interval => clearInterval(interval));
                window.uploadProgressIntervals = [];
            }
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.currentTarget.classList.add('dragover');
        }

        function handleDrop(e) {
            e.preventDefault();
            e.currentTarget.classList.remove('dragover');
            const files = Array.from(e.dataTransfer.files).filter(file => file.type.startsWith('image/'));
            if (files.length > 0) {
                selectedFiles = files;
                showFilePreview(files);
                document.getElementById('fileInput').files = e.dataTransfer.files;
            }
        }

        let selectedFiles = [];

        function handleFileSelect(e) {
            const files = Array.from(e.target.files).filter(file => file.type.startsWith('image/'));
            if (files.length > 0) {
                selectedFiles = files;
                showFilePreview(files);
            }
        }

        function showFilePreview(files) {
            const filePreview = document.getElementById('filePreview');
            const uploadBtn = document.getElementById('uploadBtn');
            
            if (files.length === 0) {
                filePreview.innerHTML = '';
                uploadBtn.style.display = 'none';
                return;
            }

            const totalSize = files.reduce((sum, file) => sum + file.size, 0);
            const totalSizeMB = (totalSize / (1024 * 1024)).toFixed(1);
            
            filePreview.innerHTML = `
                <h4>Selected Photos (${files.length}) - ${totalSizeMB}MB Total</h4>
                <div class="file-preview-grid">
                    ${files.map((file, index) => {
                        const fileSizeMB = (file.size / (1024 * 1024)).toFixed(1);
                        return `
                            <div class="file-preview-item">
                                <img src="${URL.createObjectURL(file)}" alt="Preview">
                                <button class="file-preview-remove" onclick="removeFile(${index})">&times;</button>
                                <div style="font-size: 0.7em; color: #666; margin-top: 2px;">${fileSizeMB}MB</div>
                            </div>
                        `;
                    }).join('')}
                </div>
                ${files.length > 20 ? '<div class="batch-upload-info">Large batch detected - will process in optimized chunks</div>' : ''}
            `;
            
            uploadBtn.style.display = 'inline-block';
        }

        function removeFile(index) {
            selectedFiles.splice(index, 1);
            showFilePreview(selectedFiles);
        }

        function startUpload() {
            if (selectedFiles.length === 0) {
                showMessage('No files selected for upload', 'error');
                return;
            }
            uploadFiles(selectedFiles);
        }

        async function uploadFiles(files) {
            if (!currentUploadSessionId) {
                showMessage('No session selected for upload', 'error');
                return;
            }

            try {
                const formData = new FormData();
                files.forEach(file => {
                    formData.append('photos', file);
                });

                const response = await fetch(`/api/sessions/${currentUploadSessionId}/upload-photos`, {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();

                if (response.ok) {
                    showMessage(`Successfully uploaded ${result.uploaded} photos!`, 'success');
                    closeUploadModal();
                    loadSessions(); // Refresh to show new photos
                    
                    // Trigger milestone celebration for photo upload
                    celebrateMilestone('photos_uploaded');
                } else {
                    throw new Error(result.error || 'Upload failed');
                }
            } catch (error) {
                console.error('Upload error:', error);
                showMessage('Upload failed: ' + error.message, 'error');
            }
        }

        async function deleteSession(sessionId) {
            if (!confirm('Are you sure you want to delete this session?')) return;

            try {
                const response = await fetch(`/api/sessions/${sessionId}`, {
                    method: 'DELETE'
                });

                if (response.ok) {
                    sessions = sessions.filter(s => s.id !== sessionId);
                    renderSessions();
                    showMessage('Session deleted successfully!', 'success');
                } else {
                    showMessage('Failed to delete session', 'error');
                }
            } catch (error) {
                console.error('Error deleting session:', error);
                showMessage('Error deleting session', 'error');
            }
        }

        function viewPhoto(url) {
            window.open(url, '_blank');
        }

        function formatDateTime(dateTimeString) {
            const date = new Date(dateTimeString);
            return date.toLocaleDateString('en-US', {
                weekday: 'short',
                year: 'numeric',
                month: 'short',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        function showMessage(text, type) {
            const message = document.createElement('div');
            message.textContent = text;
            message.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 25px;
                border-radius: 8px;
                color: white;
                font-weight: 600;
                z-index: 10000;
                background: ${type === 'success' ? '#48bb78' : '#e53e3e'};
            `;
            
            document.body.appendChild(message);
            setTimeout(() => message.remove(), 3000);
        }

        // Admin-only button functions
        let editingSessionId = null;

        function editSession(sessionId) {
            const session = sessions.find(s => s.id === sessionId);
            if (!session) return;
            
            editingSessionId = sessionId;
            
            // Populate the form with existing data for editing
            document.getElementById('clientName').value = session.clientName;
            document.getElementById('sessionType').value = session.sessionType;
            document.getElementById('dateTime').value = session.dateTime;
            document.getElementById('location').value = session.location;
            document.getElementById('phoneNumber').value = session.phoneNumber;
            document.getElementById('email').value = session.email;
            document.getElementById('price').value = session.price;
            document.getElementById('duration').value = session.duration;
            
            // Set checkbox states
            document.getElementById('contractSigned').checked = session.contractSigned || false;
            document.getElementById('paid').checked = session.paid || false;
            document.getElementById('edited').checked = session.edited || false;
            document.getElementById('delivered').checked = session.delivered || false;
            document.getElementById('sendReminder').checked = session.sendReminder || false;
            document.getElementById('notifyGalleryReady').checked = session.notifyGalleryReady || false;
            
            // Update form UI for editing
            const form = document.getElementById('sessionForm');
            const submitBtn = form.querySelector('button[type="submit"]');
            submitBtn.textContent = 'Update Session';
            
            // Scroll to form
            form.scrollIntoView({ behavior: 'smooth' });
            
            showMessage('Form populated for editing. Update and save changes.', 'success');
        }

        // Open email client with session details  
        function openEmailClient(sessionId) {
            const session = sessions.find(s => s.id === sessionId);
            if (!session) return;
            
            const subject = `Photography Session - ${session.sessionType} with ${session.clientName}`;
            const body = `Hi ${session.clientName},

I hope this email finds you well! I'm writing regarding your upcoming ${session.sessionType} photography session.

Session Details:
Date: ${new Date(session.dateTime).toLocaleDateString()}
Time: ${new Date(session.dateTime).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}
Location: ${session.location}
Investment: $${session.price}
Contact: ${session.phoneNumber}

I'm excited to capture these special moments for you! If you have any questions or need to make any changes, please don't hesitate to reach out.

Best regards,
Lance - The Legacy Photography
Professional Photography Services
lance@thelegacyphotography.com`;

            const mailtoUrl = `mailto:${session.email}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
            window.location.href = mailtoUrl;
        }

        // Copy gallery URL to clipboard
        async function copyGalleryUrl(sessionId) {
            try {
                showMessage('Generating gallery URL...', 'info');
                
                // Generate gallery access if not exists
                const response = await fetch(`/api/sessions/${sessionId}/generate-gallery-access`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }
                });
                
                if (!response.ok) {
                    throw new Error('Failed to generate gallery access');
                }
                
                const data = await response.json();
                const session = sessions.find(s => s.id === sessionId);
                
                console.log('Generated gallery URL:', data.galleryUrl);
                
                // Try multiple methods to copy URL with enhanced mobile support
                let copySuccess = false;
                let method = '';
                
                // Method 1: Modern clipboard API (works on HTTPS and secure contexts)
                if (navigator.clipboard && navigator.clipboard.writeText) {
                    try {
                        await navigator.clipboard.writeText(data.galleryUrl);
                        copySuccess = true;
                        method = 'clipboard API';
                        console.log('Clipboard API copy successful');
                        
                        // Trigger milestone celebration for gallery sharing
                        celebrateMilestone('gallery_shared');
                    } catch (clipboardError) {
                        console.log('Clipboard API failed:', clipboardError.message);
                    }
                }
                
                // Method 2: Enhanced textarea fallback with mobile optimization
                if (!copySuccess) {
                    try {
                        const textarea = document.createElement('textarea');
                        textarea.value = data.galleryUrl;
                        
                        // Enhanced styles for mobile compatibility
                        textarea.style.position = 'fixed';
                        textarea.style.top = '0';
                        textarea.style.left = '0';
                        textarea.style.width = '2em';
                        textarea.style.height = '2em';
                        textarea.style.padding = '0';
                        textarea.style.border = 'none';
                        textarea.style.outline = 'none';
                        textarea.style.boxShadow = 'none';
                        textarea.style.background = 'transparent';
                        textarea.style.opacity = '0';
                        textarea.style.zIndex = '-1';
                        
                        document.body.appendChild(textarea);
                        
                        // Enhanced selection for mobile devices
                        textarea.focus();
                        textarea.setSelectionRange(0, 99999);
                        textarea.select();
                        
                        // Try execCommand
                        const successful = document.execCommand('copy');
                        document.body.removeChild(textarea);
                        
                        if (successful) {
                            copySuccess = true;
                            method = 'execCommand';
                            console.log('execCommand copy successful');
                        }
                    } catch (fallbackError) {
                        console.log('Fallback copy failed:', fallbackError.message);
                    }
                }
                
                // Method 3: Share API for mobile devices (if available)
                if (!copySuccess && navigator.share) {
                    try {
                        await navigator.share({
                            title: `Gallery for ${session.clientName}`,
                            text: `View your ${session.sessionType} photos:`,
                            url: data.galleryUrl
                        });
                        method = 'share API';
                        showMessage('Gallery shared successfully!', 'success');
                        return; // Exit early since sharing was successful
                    } catch (shareError) {
                        console.log('Share API failed:', shareError.message);
                    }
                }
                
                // Always show the URL in a prompt dialog for copying
                if (copySuccess) {
                    showMessage(`Gallery URL copied successfully! (${method})`, 'success');
                    // Show confirmation with the URL
                    alert(`Gallery URL copied for ${session.clientName}!\n\nURL: ${data.galleryUrl}\n\nYou can now paste this into your email or text message.`);
                } else {
                    showMessage('Copy the URL from the dialog below', 'info');
                    // Show URL in a prompt for manual copying
                    const userAction = prompt(`Copy this gallery URL for ${session.clientName}:`, data.galleryUrl);
                    if (userAction !== null) {
                        showMessage('Gallery URL provided for copying', 'success');
                    }
                }
                
            } catch (error) {
                console.error('Error copying gallery URL:', error);
                showMessage('Failed to generate gallery URL: ' + error.message, 'error');
            }
        }

        function addToCalendar(sessionId) {
            const session = sessions.find(s => s.id === sessionId);
            if (!session) return;
            
            // For iPhone, use the server endpoint
            if (/iPhone|iPad/.test(navigator.userAgent)) {
                window.location.href = `/api/sessions/${sessionId}/calendar.ics`;
                showMessage('Opening iPhone Calendar...', 'success');
                return;
            }
            
            const startDate = new Date(session.dateTime);
            const endDate = new Date(startDate.getTime() + (session.duration * 60000));
            
            const formatDate = (date) => {
                return date.toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z';
            };
            
            const icsContent = `BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//Photography Scheduler//EN
BEGIN:VEVENT
UID:${session.id}@photographyschedule.com
DTSTAMP:${formatDate(new Date())}
DTSTART:${formatDate(startDate)}
DTEND:${formatDate(endDate)}
SUMMARY:Photography Session - ${session.clientName}
DESCRIPTION:Session Type: ${session.sessionType}\\nLocation: ${session.location}\\nClient: ${session.clientName}\\nPhone: ${session.phoneNumber}\\nEmail: ${session.email}\\nPrice: $${session.price}
LOCATION:${session.location}
END:VEVENT
END:VCALENDAR`;
            
            const blob = new Blob([icsContent], { type: 'text/calendar' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${session.clientName.replace(/\s+/g, '_')}_photography_session.ics`;
            a.click();
            URL.revokeObjectURL(url);
            
            showMessage('Calendar event downloaded!', 'success');
        }

        async function sendGalleryReady(sessionId) {
            const session = sessions.find(s => s.id === sessionId);
            if (!session) return;
            
            try {
                // First, generate gallery access token
                const generateResponse = await fetch(`/api/sessions/${sessionId}/generate-gallery-access`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }
                });
                
                if (!generateResponse.ok) {
                    throw new Error('Failed to generate gallery access');
                }
                
                const galleryData = await generateResponse.json();
                
                // Then send notification
                const notifyResponse = await fetch(`/api/sessions/${sessionId}/send-gallery-notification`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }
                });
                
                if (!notifyResponse.ok) {
                    throw new Error('Failed to send gallery notification');
                }
                
                const notifyData = await notifyResponse.json();
                
                // Show success message with gallery URL
                showMessage(`Gallery ready! Secure link sent to ${session.clientName}`, 'success');
                
                // Optional: Show the gallery URL in a popup for copying
                const showUrlConfirm = confirm(`Gallery notification sent to ${session.clientName}!\n\nGallery URL (for your reference):\n${galleryData.galleryUrl}\n\nClick OK to copy link to clipboard.`);
                
                if (showUrlConfirm) {
                    navigator.clipboard.writeText(galleryData.galleryUrl).then(() => {
                        showMessage('Gallery URL copied to clipboard!', 'success');
                    }).catch(() => {
                        // Fallback for browsers that don't support clipboard API
                        prompt('Copy this gallery URL:', galleryData.galleryUrl);
                    });
                }
                
            } catch (error) {
                console.error('Error sending gallery ready notification:', error);
                showMessage('Failed to send gallery notification: ' + error.message, 'error');
            }
        }

        async function sendInvoice(sessionId) {
            const session = sessions.find(s => s.id === sessionId);
            if (!session) return;
            
            try {
                const response = await fetch(`/api/sessions/${sessionId}/send-invoice`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }
                });
                
                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.error || 'Failed to send invoice');
                }
                
                const result = await response.json();
                
                if (result.fallbackMode) {
                    // Handle simulation mode
                    showMessage(`Invoice simulation completed for ${session.clientName}`, 'info');
                    alert(`Invoice Simulation Mode\n\nClient: ${result.clientName}\nAmount: $${result.amount}\nSession: ${result.sessionType}\n\n${result.details}`);
                } else {
                    // Handle real Stripe invoice
                    showMessage(`Invoice sent to ${session.clientName} for $${session.price}!`, 'success');
                    
                    // Trigger milestone celebration for invoice sent
                    celebrateMilestone('invoice_sent');
                    
                    // Show invoice URL
                    const showUrlConfirm = confirm(`Invoice sent successfully to ${session.clientName}!\n\nInvoice Amount: $${session.price}\nStatus: ${result.invoice ? result.invoice.status : 'sent'}\n\nClick OK to view the invoice.`);
                    
                    if (showUrlConfirm && result.invoice && result.invoice.hostedInvoiceUrl) {
                        window.open(result.invoice.hostedInvoiceUrl, '_blank');
                    }
                }
                
            } catch (error) {
                console.error('Error sending invoice:', error);
                showMessage('Failed to send invoice: ' + error.message, 'error');
            }
        }

        function callClient(phoneNumber) {
            window.location.href = `tel:${phoneNumber}`;
        }

        function textClient(phoneNumber, clientName, sessionId) {
            const session = sessions.find(s => s.id === sessionId);
            if (session && session.galleryAccessToken) {
                const galleryUrl = `${window.location.origin}/gallery/${sessionId}?access=${session.galleryAccessToken}`;
                const message = `${clientName}, your ${session.sessionType} photos are ready! View gallery: ${galleryUrl}`;
                window.location.href = `sms:${phoneNumber}?body=${encodeURIComponent(message)}`;
            } else {
                const message = `Hi ${clientName}, your photos will be ready soon! We'll send you the gallery link when they're available.`;
                window.location.href = `sms:${phoneNumber}?body=${encodeURIComponent(message)}`;
            }
        }

        async function viewGallery(sessionId) {
            const session = sessions.find(s => s.id === sessionId);
            if (!session) return;
            
            // Check if gallery access exists
            if (session.galleryAccessToken) {
                // Open existing gallery
                window.open(`/gallery/${sessionId}?access=${session.galleryAccessToken}`, '_blank');
            } else {
                // Generate gallery access first
                try {
                    const response = await fetch(`/api/sessions/${sessionId}/generate-gallery-access`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' }
                    });
                    
                    if (!response.ok) {
                        throw new Error('Failed to generate gallery access');
                    }
                    
                    const galleryData = await response.json();
                    
                    // Update local session data
                    session.galleryAccessToken = galleryData.accessToken;
                    
                    // Open gallery
                    window.open(galleryData.galleryUrl, '_blank');
                    
                } catch (error) {
                    console.error('Error generating gallery access:', error);
                    showMessage('Failed to generate gallery access: ' + error.message, 'error');
                }
            }
        }
    </script>

    <!-- Confetti Container for Milestone Celebrations -->
    <div id="confettiContainer" class="confetti-container"></div>

    <script>
        // Confetti Animation System for Milestone Celebrations
        function createConfetti(x, y, count = 50) {
            const container = document.getElementById('confettiContainer');
            const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#feca57', '#ff9ff3', '#54a0ff'];
            
            for (let i = 0; i < count; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti-piece';
                
                // Random positioning and styling
                const startX = x || Math.random() * window.innerWidth;
                const startY = y || -20;
                const color = colors[Math.floor(Math.random() * colors.length)];
                const size = Math.random() * 8 + 6;
                const duration = Math.random() * 2 + 2;
                
                confetti.style.left = startX + 'px';
                confetti.style.top = startY + 'px';
                confetti.style.backgroundColor = color;
                confetti.style.width = size + 'px';
                confetti.style.height = size + 'px';
                confetti.style.animationDuration = duration + 's';
                confetti.style.animationDelay = Math.random() * 0.5 + 's';
                
                container.appendChild(confetti);
                
                // Clean up after animation
                setTimeout(() => {
                    if (confetti && confetti.parentNode) {
                        confetti.parentNode.removeChild(confetti);
                    }
                }, (duration + 0.5) * 1000);
            }
        }
        
        function showMilestoneToast(message, emoji = 'ðŸŽ‰') {
            const toast = document.createElement('div');
            toast.className = 'milestone-toast';
            toast.innerHTML = `${emoji} ${message}`;
            
            document.body.appendChild(toast);
            
            // Remove toast after animation
            setTimeout(() => {
                if (toast && toast.parentNode) {
                    toast.parentNode.removeChild(toast);
                }
            }, 2000);
        }
        
        function celebrateMilestone(type, sessionName = '') {
            const celebrations = {
                'session_created': {
                    message: `New Session Created: ${sessionName}`,
                    emoji: '',
                    confetti: 30
                },
                'contract_signed': {
                    message: 'Contract Signed!',
                    emoji: '',
                    confetti: 25
                },
                'payment_received': {
                    message: 'Payment Received!',
                    emoji: '',
                    confetti: 40
                },
                'photos_uploaded': {
                    message: 'Photos Uploaded Successfully!',
                    emoji: '',
                    confetti: 35
                },
                'session_delivered': {
                    message: 'Session Delivered!',
                    emoji: '',
                    confetti: 45
                },
                'gallery_shared': {
                    message: 'Gallery Shared with Client!',
                    emoji: '',
                    confetti: 30
                },
                'invoice_sent': {
                    message: 'Invoice Sent Successfully!',
                    emoji: '',
                    confetti: 25
                },
                'payment_plan_created': {
                    message: 'Payment Plan Created!',
                    emoji: '',
                    confetti: 30
                }
            };
            
            const celebration = celebrations[type];
            if (!celebration) return;
            
            // Show toast message
            showMilestoneToast(celebration.message, celebration.emoji);
            
            // Trigger confetti from multiple points
            setTimeout(() => {
                createConfetti(window.innerWidth * 0.25, -20, celebration.confetti / 2);
                createConfetti(window.innerWidth * 0.75, -20, celebration.confetti / 2);
            }, 200);
        }
        
        // Global function to trigger celebrations
        window.celebrateMilestone = celebrateMilestone;

        // Payment Plan Functions
        function openPaymentPlanModal(sessionId) {
            currentPaymentPlanSessionId = sessionId;
            const session = sessions.find(s => s.id === sessionId);
            if (!session) return;
            
            // Pre-fill with session price
            document.getElementById('planTotalAmount').value = session.price;
            
            // Set default start date to today
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('planStartDate').value = today;
            
            // Set default end date to 6 months from now
            const sixMonthsLater = new Date();
            sixMonthsLater.setMonth(sixMonthsLater.getMonth() + 6);
            document.getElementById('planEndDate').value = sixMonthsLater.toISOString().split('T')[0];
            
            document.getElementById('paymentPlanModal').classList.add('active');
        }
        
        function closePaymentPlanModal() {
            document.getElementById('paymentPlanModal').classList.remove('active');
            document.getElementById('paymentPlanSummary').style.display = 'none';
            currentPaymentPlanSessionId = null;
        }
        
        function calculatePaymentPreview() {
            const totalAmount = parseFloat(document.getElementById('planTotalAmount').value);
            const startDate = new Date(document.getElementById('planStartDate').value);
            const endDate = new Date(document.getElementById('planEndDate').value);
            
            if (!totalAmount || !startDate || !endDate) {
                showMessage('Please fill in all fields', 'error');
                return;
            }
            
            if (startDate >= endDate) {
                showMessage('End date must be after start date', 'error');
                return;
            }
            
            // Calculate months between dates
            const monthsDiff = Math.max(1, (endDate.getFullYear() - startDate.getFullYear()) * 12 + (endDate.getMonth() - startDate.getMonth()));
            const monthlyPayment = (totalAmount / monthsDiff).toFixed(2);
            
            // Show summary
            const summaryElement = document.getElementById('paymentPlanSummary');
            const detailsElement = document.getElementById('paymentSummaryDetails');
            const scheduleElement = document.getElementById('paymentSchedulePreview');
            
            detailsElement.innerHTML = `
                <p><strong>Total Amount:</strong> $${totalAmount.toFixed(2)}</p>
                <p><strong>Number of Payments:</strong> ${monthsDiff}</p>
                <p><strong>Monthly Payment:</strong> $${monthlyPayment}</p>
                <p><strong>Period:</strong> ${startDate.toLocaleDateString()} to ${endDate.toLocaleDateString()}</p>
            `;
            
            // Generate payment schedule preview
            let scheduleHTML = '<h5>Payment Schedule:</h5>';
            for (let i = 0; i < Math.min(monthsDiff, 6); i++) { // Show first 6 payments
                const paymentDate = new Date(startDate);
                paymentDate.setMonth(paymentDate.getMonth() + i);
                
                scheduleHTML += `
                    <div class="payment-item">
                        <div>
                            <strong>Payment ${i + 1}</strong><br>
                            <small>${paymentDate.toLocaleDateString()}</small>
                        </div>
                        <div>$${monthlyPayment}</div>
                        <div class="payment-status pending">Pending</div>
                    </div>
                `;
            }
            
            if (monthsDiff > 6) {
                scheduleHTML += `<p><small>... and ${monthsDiff - 6} more payments</small></p>`;
            }
            
            scheduleElement.innerHTML = scheduleHTML;
            summaryElement.style.display = 'block';
        }
        
        async function createPaymentPlan() {
            const totalAmount = parseFloat(document.getElementById('planTotalAmount').value);
            const startDate = document.getElementById('planStartDate').value;
            const endDate = document.getElementById('planEndDate').value;
            const reminderDays = parseInt(document.getElementById('planReminderDays').value);
            
            if (!totalAmount || !startDate || !endDate || !currentPaymentPlanSessionId) {
                showMessage('Please fill in all fields', 'error');
                return;
            }
            
            try {
                const response = await fetch(`/api/sessions/${currentPaymentPlanSessionId}/payment-plan`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        totalAmount,
                        startDate,
                        endDate,
                        reminderDays
                    })
                });
                
                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.error || 'Failed to create payment plan');
                }
                
                const result = await response.json();
                
                closePaymentPlanModal();
                showMessage(`Payment plan created! ${result.payments.length} monthly payments of $${result.plan.monthlyPayment}`, 'success');
                
                // Refresh sessions to show updated data
                loadSessions();
                
                // Celebrate milestone
                celebrateMilestone('payment_plan_created', sessions.find(s => s.id === currentPaymentPlanSessionId)?.clientName || 'Client');
                
            } catch (error) {
                console.error('Error creating payment plan:', error);
                showMessage('Failed to create payment plan: ' + error.message, 'error');
            }
        }
        
        async function viewPaymentPlan(sessionId) {
            try {
                const response = await fetch(`/api/sessions/${sessionId}/payment-plan`);
                
                if (!response.ok) {
                    throw new Error('Payment plan not found');
                }
                
                const paymentPlan = await response.json();
                const session = sessions.find(s => s.id === sessionId);
                
                // Update modal title
                document.getElementById('paymentPlanViewTitle').textContent = `Payment Plan - ${session?.clientName || 'Client'}`;
                
                // Generate payment plan view
                let contentHTML = `
                    <div class="payment-plan-summary">
                        <h4>ðŸ“‹ Plan Overview</h4>
                        <p><strong>Total Amount:</strong> $${parseFloat(paymentPlan.totalAmount).toFixed(2)}</p>
                        <p><strong>Monthly Payment:</strong> $${parseFloat(paymentPlan.monthlyPayment).toFixed(2)}</p>
                        <p><strong>Payments Completed:</strong> ${paymentPlan.paymentsCompleted} of ${paymentPlan.totalPayments}</p>
                        <p><strong>Amount Paid:</strong> $${parseFloat(paymentPlan.amountPaid).toFixed(2)}</p>
                        <p><strong>Remaining Balance:</strong> $${parseFloat(paymentPlan.remainingBalance).toFixed(2)}</p>
                        <p><strong>Status:</strong> <span class="payment-status ${paymentPlan.status}">${paymentPlan.status.toUpperCase()}</span></p>
                    </div>
                    
                    <div class="payment-schedule">
                        <h4>Payment Schedule</h4>
                `;
                
                for (const payment of paymentPlan.payments) {
                    const dueDate = new Date(payment.dueDate);
                    const isOverdue = dueDate < new Date() && payment.status === 'pending';
                    const statusClass = isOverdue ? 'overdue' : payment.status;
                    
                    contentHTML += `
                        <div class="payment-item">
                            <div>
                                <strong>Payment ${payment.paymentNumber}</strong><br>
                                <small>Due: ${dueDate.toLocaleDateString()}</small>
                                ${payment.paidDate ? `<br><small>Paid: ${new Date(payment.paidDate).toLocaleDateString()}</small>` : ''}
                            </div>
                            <div>$${parseFloat(payment.amount).toFixed(2)}</div>
                            <div>
                                <div class="payment-status ${statusClass}">${payment.status.toUpperCase()}</div>
                                ${payment.status === 'pending' ? `
                                    <button class="btn btn-sm" onclick="markPaymentPaid('${payment.id}')" style="margin-top: 5px;">Mark Paid</button>
                                    <button class="btn btn-sm" onclick="sendPaymentInvoice('${payment.id}')" style="margin-top: 5px;">Send Invoice</button>
                                ` : ''}
                            </div>
                        </div>
                    `;
                }
                
                contentHTML += '</div>';
                
                document.getElementById('paymentPlanViewContent').innerHTML = contentHTML;
                document.getElementById('paymentPlanViewModal').classList.add('active');
                
            } catch (error) {
                console.error('Error viewing payment plan:', error);
                showMessage('Failed to load payment plan: ' + error.message, 'error');
            }
        }
        
        function closePaymentPlanViewModal() {
            document.getElementById('paymentPlanViewModal').classList.remove('active');
        }
        
        async function markPaymentPaid(paymentId) {
            try {
                const response = await fetch(`/api/payments/${paymentId}/mark-paid`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        paymentMethod: 'manual',
                        notes: 'Marked as paid by admin'
                    })
                });
                
                if (!response.ok) {
                    throw new Error('Failed to mark payment as paid');
                }
                
                showMessage('Payment marked as paid!', 'success');
                loadSessions(); // Refresh session data
                // Re-open the payment plan view to show updated status
                setTimeout(() => {
                    if (currentPaymentPlanSessionId) {
                        viewPaymentPlan(currentPaymentPlanSessionId);
                    }
                }, 500);
                
            } catch (error) {
                console.error('Error marking payment paid:', error);
                showMessage('Failed to mark payment as paid: ' + error.message, 'error');
            }
        }
        
        async function sendPaymentInvoice(paymentId) {
            try {
                const response = await fetch(`/api/payments/${paymentId}/send-invoice`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }
                });
                
                if (!response.ok) {
                    throw new Error('Failed to send invoice');
                }
                
                showMessage('Payment invoice sent successfully!', 'success');
                celebrateMilestone('invoice_sent');
                
            } catch (error) {
                console.error('Error sending payment invoice:', error);
                showMessage('Failed to send invoice: ' + error.message, 'error');
            }
        }
        
        async function processAutomatedPayments() {
            try {
                const response = await fetch('/api/payments/process-automated', {
                    method: 'POST'
                });
                
                if (!response.ok) {
                    throw new Error('Failed to process payments');
                }
                
                const result = await response.json();
                
                showMessage(`Processing complete! ${result.results.invoicesSent} invoices sent, ${result.results.remindersSent} reminders sent`, 'success');
                
                // Refresh data
                loadSessions();
                
            } catch (error) {
                console.error('Error processing automated payments:', error);
                showMessage('Failed to process payments: ' + error.message, 'error');
            }
        }

        // Contract Management Functions
        let currentContractSessionId = null;

        async function openContractModal(sessionId) {
            currentContractSessionId = sessionId;
            const session = sessions.find(s => s.id === sessionId);
            if (!session) return;

            // Load existing contracts for this session
            await loadExistingContracts(sessionId);
            
            document.getElementById('contractModal').classList.add('active');
        }

        function closeContractModal() {
            document.getElementById('contractModal').classList.remove('active');
            currentContractSessionId = null;
        }

        async function loadExistingContracts(sessionId) {
            try {
                const response = await fetch(`/api/sessions/${sessionId}/contracts`);
                if (!response.ok) {
                    throw new Error('Failed to load contracts');
                }

                const contracts = await response.json();
                const existingContractsDiv = document.getElementById('existingContracts');
                
                if (contracts.length === 0) {
                    existingContractsDiv.innerHTML = '';
                    return;
                }

                existingContractsDiv.innerHTML = `
                    <h4>Existing Contracts:</h4>
                    <div class="existing-contracts-list">
                        ${contracts.map(contract => `
                            <div class="contract-item ${contract.status}">
                                <div class="contract-item-info">
                                    <h5>${contract.contract_title}</h5>
                                    <p>Status: ${contract.status.charAt(0).toUpperCase() + contract.status.slice(1)}</p>
                                    <p>Created: ${new Date(contract.created_at).toLocaleDateString()}</p>
                                    ${contract.signed_date ? `<p>Signed: ${new Date(contract.signed_date).toLocaleDateString()}</p>` : ''}
                                </div>
                                <div class="contract-item-actions">
                                    ${contract.status === 'pending' ? `
                                        <button class="btn btn-primary btn-sm" onclick="sendContract('${contract.id}')">
                                            Send Contract
                                        </button>
                                    ` : contract.status === 'sent' ? `
                                        <span class="contract-status-badge sent">Sent</span>
                                    ` : contract.status === 'signed' ? `
                                        <span class="contract-status-badge signed">Signed</span>
                                    ` : ''}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
                
            } catch (error) {
                console.error('Error loading contracts:', error);
                showMessage('Failed to load existing contracts', 'error');
            }
        }

        async function createContract(sessionId, contractType) {
            try {
                showMessage('Creating contract...', 'info');
                
                const response = await fetch(`/api/sessions/${sessionId}/contracts`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        contractType: contractType
                    })
                });

                if (!response.ok) {
                    throw new Error('Failed to create contract');
                }

                const result = await response.json();
                
                showMessage('Contract created successfully!', 'success');
                
                // Reload the existing contracts to show the new one
                await loadExistingContracts(sessionId);
                
                // Trigger milestone celebration
                celebrateMilestone('contract_signed');
                
            } catch (error) {
                console.error('Error creating contract:', error);
                showMessage('Failed to create contract: ' + error.message, 'error');
            }
        }

        async function sendContract(contractId) {
            try {
                showMessage('Sending contract to client...', 'info');
                
                const response = await fetch(`/api/contracts/${contractId}/send`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });

                if (!response.ok) {
                    throw new Error('Failed to send contract');
                }

                const result = await response.json();
                
                showMessage('Contract sent successfully!', 'success');
                
                // Show the signing URL for reference
                alert(`Contract sent to client!\n\nSigning URL: ${result.signingUrl}\n\nThe client will receive an email with the signing link.`);
                
                // Reload existing contracts to update status
                await loadExistingContracts(currentContractSessionId);
                
            } catch (error) {
                console.error('Error sending contract:', error);
                showMessage('Failed to send contract: ' + error.message, 'error');
            }
        }

        // Send deposit invoice with custom amount
        async function sendDepositInvoice(sessionId) {
            try {
                const session = sessions.find(s => s.id === sessionId);
                if (!session) {
                    showMessage('Session not found', 'error');
                    return;
                }

                // Prompt user for deposit amount
                const depositAmountInput = prompt(
                    `Enter deposit/retainer amount for ${session.clientName}:\n\nSession Total: $${session.price}\nSuggested 50%: $${(session.price * 0.5).toFixed(2)}`,
                    (session.price * 0.5).toFixed(2)
                );
                
                if (!depositAmountInput) {
                    return; // User cancelled
                }
                
                const depositAmount = parseFloat(depositAmountInput);
                
                if (isNaN(depositAmount) || depositAmount <= 0) {
                    showMessage('Please enter a valid amount greater than $0', 'error');
                    return;
                }
                
                if (depositAmount > session.price) {
                    const confirmOverage = confirm(
                        `Deposit amount ($${depositAmount}) is more than the session total ($${session.price}).\n\nDo you want to continue?`
                    );
                    if (!confirmOverage) {
                        return;
                    }
                }
                
                console.log('Creating deposit invoice for session:', session);
                showMessage('Creating deposit invoice...', 'info');
                
                const authToken = await getAuthToken();
                const headers = {
                    'Content-Type': 'application/json'
                };
                
                if (authToken) {
                    headers['Authorization'] = `Bearer ${authToken}`;
                }
                
                const response = await fetch('/api/create-invoice', {
                    method: 'POST',
                    headers,
                    body: JSON.stringify({
                        sessionId: session.id,
                        clientName: session.clientName,
                        email: session.email,
                        amount: depositAmount,
                        description: `Retainer for ${session.sessionType} Photography Session (Total: $${session.price})`,
                        dueDate: new Date(Date.now() + 14 * 24 * 60 * 60 * 1000).toISOString(), // 14 days for deposit
                        isDeposit: true,
                        depositAmount: depositAmount,
                        totalAmount: session.price
                    })
                });
                
                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`Failed to create deposit invoice: ${errorText}`);
                }
                
                const result = await response.json();
                console.log('Deposit invoice creation result:', result);
                
                if (result.success && result.invoice_url) {
                    showMessage('Deposit invoice created successfully!', 'success');
                    
                    // Trigger celebration confetti
                    celebrateMilestone('invoice_sent', session.clientName);
                    
                    // Open the invoice URL in a new tab
                    window.open(result.invoice_url, '_blank');
                    
                    // Show a dialog with invoice details
                    const remainingBalance = session.price - depositAmount;
                    const message = `Deposit invoice created successfully!\n\nRetainer: $${depositAmount}\nRemaining Balance: $${remainingBalance.toFixed(2)}\n\nInvoice URL: ${result.invoice_url}\n\nThe invoice has been sent to ${session.email}`;
                    alert(message);
                } else {
                    throw new Error(result.error || 'Unknown error creating deposit invoice');
                }
                
            } catch (error) {
                console.error('Error creating deposit invoice:', error);
                showMessage('Error creating deposit invoice: ' + error.message, 'error');
            }
        }

        // Get authentication token helper function
        async function getAuthToken() {
            try {
                const response = await fetch('/api/auth/user');
                if (response.ok) {
                    return 'authenticated'; // Simplified token for authenticated requests
                }
                return null;
            } catch (error) {
                console.error('Error getting auth token:', error);
                return null;
            }
        }

        // Tab switching functionality
        function switchTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all nav tabs
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName + 'Tab').classList.add('active');
            
            // Set active nav tab
            event.target.classList.add('active');
            
            // Initialize website builder if switching to websites tab
            if (tabName === 'websites') {
                initializeWebsiteBuilder();
            }
        }

        // Photography Website Builder Functionality
        let currentTemplate = null;
        let websiteSettings = {
            businessName: 'The Legacy Photography',
            tagline: 'Capturing Timeless Moments',
            aboutText: 'Professional photographer specializing in weddings, portraits, and special moments. Creating beautiful memories that last a lifetime.',
            contactPhone: '843-485-1315',
            contactEmail: 'lance@thelegacyphotography.com',
            primaryColor: '#D4AF37',
            backgroundColor: '#1a1a1a',
            textColor: '#ffffff',
            fontStyle: 'serif',
            galleryLayout: 'grid',
            websiteUrl: '',
            seoTitle: 'The Legacy Photography - Professional Wedding & Portrait Photographer',
            seoDescription: 'Professional photography services specializing in weddings, portraits, and special moments. Book your session today.',
            portfolioPhotos: []
        };

        function initializeWebsiteBuilder() {
            console.log('Initializing photography website builder...');
            // Show template selection by default
            showTemplateSelection();
        }

        function showTemplateSelection() {
            document.getElementById('templateSelection').style.display = 'block';
            document.getElementById('websiteCustomization').style.display = 'none';
        }

        function selectTemplate(templateType) {
            currentTemplate = templateType;
            
            // Update UI
            document.getElementById('templateSelection').style.display = 'none';
            document.getElementById('websiteCustomization').style.display = 'block';
            document.getElementById('selectedTemplateName').textContent = `Customizing: ${getTemplateDisplayName(templateType)}`;
            
            // Load template-specific default settings
            loadTemplateDefaults(templateType);
            
            // Generate initial preview
            updateWebsitePreview();
            
            showMessage(`${getTemplateDisplayName(templateType)} template selected!`, 'success');
            celebrateMilestone('session_created', `${getTemplateDisplayName(templateType)} Website`);
        }

        function getTemplateDisplayName(templateType) {
            const names = {
                legacy: 'Legacy Style',
                modern: 'Modern Portfolio',
                romantic: 'Romantic Style',
                bold: 'Bold & Dramatic'
            };
            return names[templateType] || templateType;
        }

        function loadTemplateDefaults(templateType) {
            const templateDefaults = {
                legacy: {
                    primaryColor: '#D4AF37',
                    backgroundColor: '#1a1a1a',
                    textColor: '#ffffff',
                    fontStyle: 'serif'
                },
                modern: {
                    primaryColor: '#667eea',
                    backgroundColor: '#ffffff',
                    textColor: '#2d3748',
                    fontStyle: 'sans-serif'
                },
                romantic: {
                    primaryColor: '#d4a574',
                    backgroundColor: '#fdf7f0',
                    textColor: '#8b5a3c',
                    fontStyle: 'serif'
                },
                bold: {
                    primaryColor: '#ffffff',
                    backgroundColor: '#000000',
                    textColor: '#ffffff',
                    fontStyle: 'sans-serif'
                }
            };

            const defaults = templateDefaults[templateType];
            if (defaults) {
                Object.assign(websiteSettings, defaults);
                updateFormFields();
            }
        }

        function backToTemplates() {
            // Reset current template
            currentTemplate = null;
            
            // Show template selection
            document.getElementById('templateSelection').style.display = 'block';
            document.getElementById('websiteCustomization').style.display = 'none';
            
            showMessage('Back to template selection', 'info');
        }

        function showCustomizationSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('.customization-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(sectionName + 'Customization').classList.add('active');
            
            // Update tab states
            document.querySelectorAll('.customization-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        function updateFormFields() {
            // Update form fields with current settings
            document.getElementById('businessName').value = websiteSettings.businessName;
            document.getElementById('tagline').value = websiteSettings.tagline;
            document.getElementById('aboutText').value = websiteSettings.aboutText;
            document.getElementById('contactPhone').value = websiteSettings.contactPhone;
            document.getElementById('contactEmail').value = websiteSettings.contactEmail;
            document.getElementById('primaryColor').value = websiteSettings.primaryColor;
            document.getElementById('backgroundColor').value = websiteSettings.backgroundColor;
            document.getElementById('textColor').value = websiteSettings.textColor;
            document.getElementById('fontStyle').value = websiteSettings.fontStyle;
            document.getElementById('galleryLayout').value = websiteSettings.galleryLayout;
            document.getElementById('websiteUrl').value = websiteSettings.websiteUrl;
            document.getElementById('seoTitle').value = websiteSettings.seoTitle;
            document.getElementById('seoDescription').value = websiteSettings.seoDescription;
        }

        function updateWebsiteContent() {
            // Update settings from form fields
            websiteSettings.businessName = document.getElementById('businessName').value;
            websiteSettings.tagline = document.getElementById('tagline').value;
            websiteSettings.aboutText = document.getElementById('aboutText').value;
            websiteSettings.contactPhone = document.getElementById('contactPhone').value;
            websiteSettings.contactEmail = document.getElementById('contactEmail').value;
            
            // Update preview
            updateWebsitePreview();
        }

        function updateWebsiteDesign() {
            // Update design settings from form fields
            websiteSettings.primaryColor = document.getElementById('primaryColor').value;
            websiteSettings.backgroundColor = document.getElementById('backgroundColor').value;
            websiteSettings.textColor = document.getElementById('textColor').value;
            websiteSettings.fontStyle = document.getElementById('fontStyle').value;
            
            // Update preview
            updateWebsitePreview();
        }

        function updateGallerySettings() {
            websiteSettings.galleryLayout = document.getElementById('galleryLayout').value;
            updateWebsitePreview();
        }

        function updateWebsiteSettings() {
            websiteSettings.websiteUrl = document.getElementById('websiteUrl').value;
            websiteSettings.seoTitle = document.getElementById('seoTitle').value;
            websiteSettings.seoDescription = document.getElementById('seoDescription').value;
        }

        function handlePhotoUpload() {
            const files = document.getElementById('portfolioPhotos').files;
            const photoPreview = document.getElementById('photoPreview');
            
            photoPreview.innerHTML = '';
            websiteSettings.portfolioPhotos = [];
            
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    websiteSettings.portfolioPhotos.push({
                        url: e.target.result,
                        name: file.name
                    });
                    
                    const photoItem = document.createElement('div');
                    photoItem.className = 'photo-preview-item';
                    photoItem.innerHTML = `<img src="${e.target.result}" alt="${file.name}">`;
                    photoPreview.appendChild(photoItem);
                    
                    updateWebsitePreview();
                };
                
                reader.readAsDataURL(file);
            }
        }

        function setPreviewDevice(device) {
            const previewFrame = document.getElementById('websitePreview');
            const controls = document.querySelectorAll('.preview-control');
            
            // Remove active class from all controls
            controls.forEach(control => control.classList.remove('active'));
            
            // Add active class to selected control
            event.target.classList.add('active');
            
            // Update preview frame class
            previewFrame.className = `website-preview-frame ${device}`;
        }

        function updateWebsitePreview() {
            if (!currentTemplate) return;
            
            const previewFrame = document.getElementById('websitePreview');
            const websiteHTML = generateWebsiteHTML();
            
            previewFrame.innerHTML = websiteHTML;
        }

        function generateWebsiteHTML() {
            const templates = {
                legacy: generateLegacyTemplate(),
                modern: generateModernTemplate(),
                romantic: generateRomanticTemplate(),
                bold: generateBoldTemplate()
            };
            
            return templates[currentTemplate] || templates.legacy;
        }

        function generateLegacyTemplate() {
            const galleryPhotos = websiteSettings.portfolioPhotos.length > 0 
                ? websiteSettings.portfolioPhotos.slice(0, 6)
                : [
                    { url: 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 200"%3E%3Crect fill="%23333" width="300" height="200"/%3E%3Ctext x="50%25" y="50%25" text-anchor="middle" fill="%23D4AF37" font-size="16"%3EPortfolio%3C/text%3E%3C/svg%3E', name: 'sample1' },
                    { url: 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 200"%3E%3Crect fill="%23333" width="300" height="200"/%3E%3Ctext x="50%25" y="50%25" text-anchor="middle" fill="%23D4AF37" font-size="16"%3EPhoto 1%3C/text%3E%3C/svg%3E', name: 'sample2' },
                    { url: 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 200"%3E%3Crect fill="%23333" width="300" height="200"/%3E%3Ctext x="50%25" y="50%25" text-anchor="middle" fill="%23D4AF37" font-size="16"%3EPhoto 2%3C/text%3E%3C/svg%3E', name: 'sample3' }
                ];

            return `
                <div style="font-family: ${websiteSettings.fontStyle === 'serif' ? 'Georgia, serif' : websiteSettings.fontStyle === 'script' ? 'Dancing Script, cursive' : 'Arial, sans-serif'}; background: ${websiteSettings.backgroundColor}; color: ${websiteSettings.textColor}; min-height: 100vh;">
                    <!-- Header -->
                    <header style="background: linear-gradient(135deg, ${websiteSettings.backgroundColor} 0%, #2d2d2d 100%); padding: 20px; text-align: center; border-bottom: 2px solid ${websiteSettings.primaryColor};">
                        <h1 style="color: ${websiteSettings.primaryColor}; font-size: 2.5rem; margin: 0;">${websiteSettings.businessName}</h1>
                        <nav style="margin-top: 15px;">
                            <a href="#home" style="color: ${websiteSettings.textColor}; margin: 0 20px; text-decoration: none; opacity: 0.8;">Home</a>
                            <a href="#portfolio" style="color: ${websiteSettings.textColor}; margin: 0 20px; text-decoration: none; opacity: 0.8;">Portfolio</a>
                            <a href="#about" style="color: ${websiteSettings.textColor}; margin: 0 20px; text-decoration: none; opacity: 0.8;">About</a>
                            <a href="#contact" style="color: ${websiteSettings.textColor}; margin: 0 20px; text-decoration: none; opacity: 0.8;">Contact</a>
                        </nav>
                    </header>

                    <!-- Hero Section -->
                    <section style="padding: 100px 20px; text-align: center; background: linear-gradient(135deg, ${websiteSettings.backgroundColor} 0%, #2d2d2d 100%);">
                        <h2 style="font-size: 3.5rem; color: ${websiteSettings.primaryColor}; margin-bottom: 20px;">${websiteSettings.tagline}</h2>
                        <p style="font-size: 1.3rem; color: ${websiteSettings.textColor}; opacity: 0.9; max-width: 600px; margin: 0 auto 40px auto;">${websiteSettings.aboutText}</p>
                        <button style="background: ${websiteSettings.primaryColor}; color: ${websiteSettings.backgroundColor}; padding: 15px 30px; border: none; border-radius: 8px; font-size: 1.1rem; cursor: pointer;">Book Your Session</button>
                    </section>

                    <!-- Portfolio Gallery -->
                    <section style="padding: 80px 20px; background: ${websiteSettings.backgroundColor};">
                        <h3 style="text-align: center; font-size: 2.5rem; color: ${websiteSettings.primaryColor}; margin-bottom: 50px;">Portfolio</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; max-width: 1200px; margin: 0 auto;">
                            ${galleryPhotos.map(photo => `
                                <div style="aspect-ratio: 4/3; overflow: hidden; border-radius: 8px; border: 2px solid ${websiteSettings.primaryColor};">
                                    <img src="${photo.url}" alt="${photo.name}" style="width: 100%; height: 100%; object-fit: cover;">
                                </div>
                            `).join('')}
                        </div>
                    </section>

                    <!-- Contact Section -->
                    <section style="padding: 80px 20px; background: linear-gradient(135deg, #2d2d2d 0%, ${websiteSettings.backgroundColor} 100%); text-align: center;">
                        <h3 style="font-size: 2.5rem; color: ${websiteSettings.primaryColor}; margin-bottom: 30px;">Contact</h3>
                        <p style="font-size: 1.2rem; color: ${websiteSettings.textColor}; margin-bottom: 20px;">Ready to capture your special moments?</p>
                        <p style="color: ${websiteSettings.primaryColor}; font-size: 1.3rem; margin-bottom: 10px;">${websiteSettings.contactPhone}</p>
                        <p style="color: ${websiteSettings.primaryColor}; font-size: 1.1rem;">${websiteSettings.contactEmail}</p>
                    </section>

                    <!-- Footer -->
                    <footer style="background: ${websiteSettings.backgroundColor}; padding: 40px 20px; text-align: center; border-top: 1px solid ${websiteSettings.primaryColor};">
                        <p style="color: ${websiteSettings.textColor}; opacity: 0.7;">Â© 2025 ${websiteSettings.businessName}. All rights reserved.</p>
                    </footer>
                </div>
            `;
        }

        function previewWebsite() {
            if (!currentTemplate) {
                showMessage('Please select a template first', 'error');
                return;
            }
            
            showMessage('Generating full website preview...', 'info');
            
            const websiteHTML = generateWebsiteHTML();
            const previewHTML = `
                <!DOCTYPE html>
                <html lang="en">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>${websiteSettings.seoTitle}</title>
                    <meta name="description" content="${websiteSettings.seoDescription}">
                    <style>
                        * { margin: 0; padding: 0; box-sizing: border-box; }
                        body { line-height: 1.6; }
                        @media (max-width: 768px) {
                            [style*="grid-template-columns"] { grid-template-columns: 1fr !important; }
                            [style*="font-size: 3.5rem"] { font-size: 2.5rem !important; }
                            [style*="font-size: 2.5rem"] { font-size: 1.8rem !important; }
                            [style*="padding: 100px"] { padding: 50px 20px !important; }
                            [style*="padding: 80px"] { padding: 40px 20px !important; }
                        }
                    </style>
                </head>
                <body>
                    ${websiteHTML}
                </body>
                </html>
            `;
            
            const previewWindow = window.open('', '_blank', 'width=1200,height=800,scrollbars=yes,resizable=yes');
            previewWindow.document.write(previewHTML);
            previewWindow.document.close();
            
            showMessage('Website preview opened in new tab!', 'success');
            celebrateMilestone('gallery_shared', 'Website Preview');
        }

        function generateModernTemplate() {
            const galleryPhotos = websiteSettings.portfolioPhotos.length > 0 
                ? websiteSettings.portfolioPhotos.slice(0, 6)
                : [
                    { url: 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 200"%3E%3Crect fill="%23f8fafc" width="300" height="200"/%3E%3Ctext x="50%25" y="50%25" text-anchor="middle" fill="%23667eea" font-size="16"%3EModern%3C/text%3E%3C/svg%3E', name: 'sample1' },
                    { url: 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 200"%3E%3Crect fill="%23f8fafc" width="300" height="200"/%3E%3Ctext x="50%25" y="50%25" text-anchor="middle" fill="%23667eea" font-size="16"%3EPhoto 1%3C/text%3E%3C/svg%3E', name: 'sample2' },
                    { url: 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 200"%3E%3Crect fill="%23f8fafc" width="300" height="200"/%3E%3Ctext x="50%25" y="50%25" text-anchor="middle" fill="%23667eea" font-size="16"%3EPhoto 2%3C/text%3E%3C/svg%3E', name: 'sample3' }
                ];

            return `
                <div style="font-family: ${websiteSettings.fontStyle === 'serif' ? 'Georgia, serif' : websiteSettings.fontStyle === 'script' ? 'Dancing Script, cursive' : 'Arial, sans-serif'}; background: ${websiteSettings.backgroundColor}; color: ${websiteSettings.textColor}; min-height: 100vh;">
                    <!-- Header -->
                    <header style="background: ${websiteSettings.backgroundColor}; padding: 20px; text-align: center; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                        <h1 style="color: ${websiteSettings.primaryColor}; font-size: 2.5rem; margin: 0; font-weight: 300;">${websiteSettings.businessName}</h1>
                        <nav style="margin-top: 15px;">
                            <a href="#home" style="color: ${websiteSettings.textColor}; margin: 0 20px; text-decoration: none;">Home</a>
                            <a href="#portfolio" style="color: ${websiteSettings.textColor}; margin: 0 20px; text-decoration: none;">Portfolio</a>
                            <a href="#about" style="color: ${websiteSettings.textColor}; margin: 0 20px; text-decoration: none;">About</a>
                            <a href="#contact" style="color: ${websiteSettings.textColor}; margin: 0 20px; text-decoration: none;">Contact</a>
                        </nav>
                    </header>

                    <!-- Hero Section -->
                    <section style="padding: 120px 20px; text-align: center; background: linear-gradient(135deg, ${websiteSettings.backgroundColor} 0%, #f8fafc 100%);">
                        <h2 style="font-size: 4rem; color: ${websiteSettings.primaryColor}; margin-bottom: 20px; font-weight: 100;">${websiteSettings.tagline}</h2>
                        <p style="font-size: 1.2rem; color: ${websiteSettings.textColor}; opacity: 0.8; max-width: 600px; margin: 0 auto 40px auto;">${websiteSettings.aboutText}</p>
                        <button style="background: ${websiteSettings.primaryColor}; color: white; padding: 15px 40px; border: none; border-radius: 30px; font-size: 1rem; cursor: pointer; font-weight: 500;">Get Started</button>
                    </section>

                    <!-- Portfolio Gallery -->
                    <section style="padding: 100px 20px; background: ${websiteSettings.backgroundColor};">
                        <h3 style="text-align: center; font-size: 3rem; color: ${websiteSettings.textColor}; margin-bottom: 60px; font-weight: 200;">Portfolio</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 30px; max-width: 1200px; margin: 0 auto;">
                            ${galleryPhotos.map(photo => `
                                <div style="aspect-ratio: 4/3; overflow: hidden; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.1);">
                                    <img src="${photo.url}" alt="${photo.name}" style="width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s;">
                                </div>
                            `).join('')}
                        </div>
                    </section>

                    <!-- Contact Section -->
                    <section style="padding: 100px 20px; background: linear-gradient(135deg, #f8fafc 0%, ${websiteSettings.backgroundColor} 100%); text-align: center;">
                        <h3 style="font-size: 3rem; color: ${websiteSettings.textColor}; margin-bottom: 30px; font-weight: 200;">Let's Connect</h3>
                        <p style="font-size: 1.1rem; color: ${websiteSettings.textColor}; margin-bottom: 30px; opacity: 0.8;">Ready to create something beautiful together?</p>
                        <p style="color: ${websiteSettings.primaryColor}; font-size: 1.4rem; margin-bottom: 10px; font-weight: 500;">${websiteSettings.contactPhone}</p>
                        <p style="color: ${websiteSettings.primaryColor}; font-size: 1.1rem;">${websiteSettings.contactEmail}</p>
                    </section>

                    <!-- Footer -->
                    <footer style="background: ${websiteSettings.textColor}; padding: 40px 20px; text-align: center;">
                        <p style="color: ${websiteSettings.backgroundColor}; opacity: 0.7;">Â© 2025 ${websiteSettings.businessName}. Crafted with care.</p>
                    </footer>
                </div>
            `;
        }

        function generateRomanticTemplate() {
            return generateLegacyTemplate(); // Use legacy template structure with romantic colors
        }

        function generateBoldTemplate() {
            return generateModernTemplate(); // Use modern template structure with bold colors
        }

        function publishWebsite() {
            if (!currentTemplate) {
                showMessage('Please select a template first', 'error');
                return;
            }
            
            showMessage('Publishing website...', 'info');
            
            setTimeout(() => {
                const websiteUrl = websiteSettings.websiteUrl || websiteSettings.businessName.toLowerCase().replace(/\s+/g, '-');
                const publishedUrl = `https://${websiteUrl}.replit.app`;
                showMessage('Website published successfully!', 'success');
                celebrateMilestone('session_delivered', websiteSettings.businessName);
                
                alert(`Website Published!\n\nLive URL: ${publishedUrl}\n\nYour photography website is now live and ready for clients. Share this link to showcase your work!`);
            }, 2000);
        }

        // Website builder utility functions
        function resetWebsiteBuilder() {
            currentTemplate = null;
            websiteSettings = {
                businessName: 'The Legacy Photography',
                tagline: 'Capturing Timeless Moments',
                aboutText: 'Professional photographer specializing in weddings, portraits, and special moments. Creating beautiful memories that last a lifetime.',
                contactPhone: '843-485-1315',
                contactEmail: 'lance@thelegacyphotography.com',
                primaryColor: '#D4AF37',
                backgroundColor: '#1a1a1a',
                textColor: '#ffffff',
                fontStyle: 'serif',
                galleryLayout: 'grid',
                websiteUrl: '',
                seoTitle: 'The Legacy Photography - Professional Wedding & Portrait Photographer',
                seoDescription: 'Professional photography services specializing in weddings, portraits, and special moments. Book your session today.',
                portfolioPhotos: []
            };
            showTemplateSelection();
        }

        // Template Loading Functions
        function showTemplateLoading(templateType) {
            showMessage(`Loading ${getTemplateDisplayName(templateType)} template...`, 'info');
            
            // Show loading animation
            setTimeout(() => {
                selectTemplate(templateType);
            }, 800);
        }

        // Website Save/Load Functions
        function saveWebsite() {
            if (!currentTemplate) {
                showMessage('Please select a template first', 'error');
                return;
            }
            
            const websiteData = {
                template: currentTemplate,
                settings: websiteSettings,
                savedAt: new Date().toISOString()
            };
            
            localStorage.setItem('photography_website', JSON.stringify(websiteData));
            showMessage('Website saved successfully!', 'success');
        }

        function loadSavedWebsite() {
            const savedData = localStorage.getItem('photography_website');
            if (savedData) {
                const websiteData = JSON.parse(savedData);
                currentTemplate = websiteData.template;
                websiteSettings = websiteData.settings;
                
                selectTemplate(currentTemplate);
                showMessage('Saved website loaded!', 'success');
            } else {
                showMessage('No saved website found', 'error');
            }
        }

        // End of Photography Website Builder
        // ========================================
        // REVOLUTIONARY WEBSITE BUILDER FUNCTIONS
        // ========================================

        // Website Builder State
        let builderMode = 'template';
        let brandSettings = {
            logo: 'attached_assets/logo_1753330290399.png',
            businessName: 'The Legacy Photography',
            primaryFont: 'system',
            colors: {
                primary: '#d4af37',
                secondary: '#f4e4bc',
                accent: '#8b7355',
                text: '#ffffff'
            }
        };
        let selectedElement = null;
        
        // REVOLUTIONARY LIGHTBOX GALLERY SYSTEM
        function openLightbox(imageUrl, description) {
            const lightbox = document.createElement('div');
            lightbox.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
                background: rgba(0,0,0,0.95); z-index: 10000; display: flex; 
                align-items: center; justify-content: center; cursor: pointer;
                backdrop-filter: blur(15px); animation: lightboxFadeIn 0.4s ease;
            `;
            
            lightbox.innerHTML = `
                <div onclick="event.stopPropagation()" style="max-width: 90%; max-height: 90%; text-align: center; animation: lightboxZoomIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);">
                    <img src="${imageUrl}" style="max-width: 100%; max-height: 80vh; border-radius: 15px; box-shadow: 0 25px 80px rgba(0,0,0,0.8), 0 0 40px rgba(212,175,55,0.3);">
                    <p style="color: #f4e4bc; margin-top: 25px; font-size: 1.3em; font-style: italic; max-width: 600px; margin-left: auto; margin-right: auto; line-height: 1.6;">${description}</p>
                    <button onclick="document.body.removeChild(this.closest('.revolutionary-lightbox'))" style="margin-top: 25px; background: linear-gradient(135deg, #d4af37, #f4e4bc); color: #1a1a1a; border: none; padding: 15px 30px; border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 16px; box-shadow: 0 8px 25px rgba(212,175,55,0.3); transition: all 0.3s ease;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">âœ¨ Close Gallery</button>
                </div>
                <style>
                    @keyframes lightboxFadeIn { from { opacity: 0; } to { opacity: 1; } }
                    @keyframes lightboxZoomIn { from { transform: scale(0.7) rotate(-5deg); opacity: 0; } to { transform: scale(1) rotate(0deg); opacity: 1; } }
                    @keyframes pulse-invite { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
                    @keyframes bounce { 0%, 20%, 50%, 80%, 100% { transform: translateY(0); } 40% { transform: translateY(-8px); } 60% { transform: translateY(-4px); } }
                    @keyframes galleryBounce { 0% { transform: translateY(0); } 50% { transform: translateY(-10px); } 100% { transform: translateY(0); } }
                </style>
            `;
            
            lightbox.className = 'revolutionary-lightbox';
            lightbox.onclick = () => document.body.removeChild(lightbox);
            document.body.appendChild(lightbox);
        }
        
        // SMOOTH SCROLL TO GALLERY WITH BOUNCE EFFECT
        function scrollToGallery() {
            const gallery = document.getElementById('photoGallery') || document.querySelector('[style*="Featured Work"]').parentElement;
            if (gallery) {
                gallery.scrollIntoView({ behavior: 'smooth', block: 'center' });
                // Add a subtle bounce animation to the gallery
                setTimeout(() => {
                    gallery.style.animation = 'galleryBounce 0.6s ease-out';
                    setTimeout(() => { gallery.style.animation = ''; }, 600);
                }, 800);
            }
        }

        // CONTACT FORM FUNCTIONALITY
        function sendContactEmail() {
            const name = document.getElementById('contactName')?.value || '';
            const email = document.getElementById('contactEmail')?.value || '';
            const phone = document.getElementById('contactPhone')?.value || '';
            const message = document.getElementById('contactMessage')?.value || '';

            if (!name || !email || !message) {
                alert('Please fill in your name, email, and message before sending.');
                return;
            }

            const subject = `Photography Inquiry from ${name}`;
            const body = `Hi Lance,

${message}

Contact Details:
- Name: ${name}
- Email: ${email}
${phone ? `- Phone: ${phone}` : ''}

Looking forward to hearing from you!

Best regards,
${name}`;

            const mailtoLink = `mailto:lance@thelegacyphotography.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
            window.open(mailtoLink, '_self');
        }

        function sendQuickText() {
            const name = document.getElementById('contactName')?.value || 'Someone';
            const message = `Hi Lance! ${name} here. I found your website and absolutely love your photography style! I'm interested in booking a session. When are you available to chat about my vision?`;
            const smsLink = `sms:8434851315?&body=${encodeURIComponent(message)}`;
            window.open(smsLink, '_self');
        }

        // Builder Mode Switching
        function switchBuilderMode(mode) {
            builderMode = mode;
            
            // Update button states
            document.getElementById('templateModeBtn').classList.toggle('active', mode === 'template');
            document.getElementById('customModeBtn').classList.toggle('active', mode === 'custom');
            
            // Show/hide appropriate interface
            document.getElementById('templateGalleryMode').classList.toggle('active', mode === 'template');
            document.getElementById('customBuilderMode').classList.toggle('active', mode === 'custom');
            
            console.log(`ðŸ”„ Switched to ${mode} mode`);
        }

        // Template System
        function useTemplate(templateType) {
            console.log(`ðŸ“‹ Loading ${templateType} template...`);
            
            // Switch to custom mode to show the built template
            switchBuilderMode('custom');
            
            // Clear existing content
            const websiteContent = document.getElementById('websiteContent');
            websiteContent.innerHTML = '';
            
            // Generate template based on type
            generateTemplate(templateType);
            
            // Show success message (confetti function may not be available in builder context)
            console.log('Template loaded successfully! Ready for customization.');
        }

        function generateTemplate(templateType) {
            const templates = {
                legacy: () => {
                    // Update brand colors for legacy theme
                    brandSettings.colors.primary = '#1a1a1a';
                    brandSettings.colors.secondary = '#8b7355';
                    brandSettings.colors.accent = '#d4af37';
                    
                    const components = [
                        { type: 'hero', style: 'background: linear-gradient(135deg, #1a1a1a 0%, #8b7355 100%);' },
                        { type: 'about', style: 'background: #f8f6f0;' },
                        { type: 'gallery', style: 'background: white;' },
                        { type: 'services', style: 'background: #1a1a1a; color: #8b7355;' },
                        { type: 'contact', style: 'background: #8b7355;' }
                    ];
                    
                    components.forEach((comp, index) => {
                        setTimeout(() => {
                            createTemplateComponent(comp.type, index * 300, comp.style);
                        }, index * 300);
                    });
                },
                
                modern: () => {
                    const components = [
                        { type: 'hero', style: 'background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);' },
                        { type: 'gallery', style: 'background: #f8f9fa;' },
                        { type: 'about', style: 'background: white;' },
                        { type: 'services', style: 'background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;' },
                        { type: 'contact', style: 'background: #2d3748; color: white;' }
                    ];
                    
                    components.forEach((comp, index) => {
                        setTimeout(() => {
                            createTemplateComponent(comp.type, index * 350, comp.style);
                        }, index * 300);
                    });
                },
                
                elegant: () => {
                    brandSettings.colors.primary = '#8B4513';
                    brandSettings.colors.secondary = '#D2B48C';
                    brandSettings.colors.accent = '#CD853F';
                    brandSettings.primaryFont = 'serif';
                    
                    const components = [
                        { type: 'hero', style: 'background: linear-gradient(135deg, #8B4513 0%, #D2B48C 100%);' },
                        { type: 'gallery', style: 'background: #FDF5E6;' },
                        { type: 'about', style: 'background: white;' },
                        { type: 'services', style: 'background: #8B4513; color: #D2B48C;' },
                        { type: 'contact', style: 'background: #D2B48C; color: #8B4513;' }
                    ];
                    
                    components.forEach((comp, index) => {
                        setTimeout(() => {
                            createTemplateComponent(comp.type, index * 300, comp.style);
                        }, index * 300);
                    });
                },
                
                'legacy-elite': () => {
                    // Your custom colors based on actual website
                    brandSettings.colors.primary = '#d4af37';
                    brandSettings.colors.secondary = '#8b7355';
                    brandSettings.colors.accent = '#f4e4bc';
                    brandSettings.colors.text = '#ffffff';
                    brandSettings.primaryFont = 'playfair';
                    brandSettings.businessName = 'The Legacy Photography';
                    
                    const components = [
                        { 
                            type: 'legacy-hero', 
                            style: 'background: linear-gradient(135deg, #0f0f0f 0%, #1a1a1a 50%, #2c1810 100%); position: relative;' 
                        },
                        { 
                            type: 'legacy-philosophy', 
                            style: 'background: linear-gradient(135deg, #2c1810 0%, #1a1a1a 100%); color: #d4af37;' 
                        },
                        { 
                            type: 'legacy-gallery', 
                            style: 'background: #0f0f0f; color: #d4af37;' 
                        },
                        { 
                            type: 'legacy-testimonials', 
                            style: 'background: linear-gradient(135deg, #8b7355 0%, #d4af37 100%); color: #1a1a1a;' 
                        },
                        { 
                            type: 'legacy-about', 
                            style: 'background: linear-gradient(135deg, #1a1a1a 0%, #2c1810 100%); color: #f4e4bc;' 
                        },
                        { 
                            type: 'legacy-services', 
                            style: 'background: linear-gradient(135deg, #0f0f0f 0%, #2c1810 100%); color: #f4e4bc;' 
                        },
                        { 
                            type: 'legacy-contact', 
                            style: 'background: linear-gradient(135deg, #8b7355 0%, #d4af37 100%); color: #1a1a1a;' 
                        }
                    ];
                    
                    components.forEach((comp, index) => {
                        setTimeout(() => {
                            createTemplateComponent(comp.type, index * 400, comp.style);
                        }, index * 400);
                    });
                    
                    // Show special success message for your custom template
                    setTimeout(() => {
                        console.log('ðŸ”¥ Legacy Elite template loaded! Your brand is perfectly captured!');
                    }, 2000);
                }
            };
            
            if (templates[templateType]) {
                templates[templateType]();
            }
        }

        function createTemplateComponent(type, yPosition, customStyle) {
            const element = document.createElement('div');
            element.className = 'website-component draggable-element element-enter';
            element.style.position = 'relative';
            element.style.width = '100%';
            element.style.minHeight = '300px';
            element.style.fontFamily = getFontFamily();
            element.dataset.componentType = type;
            
            const components = {
                hero: `<div style="${customStyle} padding: 80px 20px; text-align: center; color: white;">
                    <div class="logo-placeholder" style="margin-bottom: 20px; display: flex; justify-content: center;">
                        ${brandSettings.logo ? `<img src="${brandSettings.logo}" style="height: 60px; width: auto;">` : 'ðŸ¢ Logo Here'}
                    </div>
                    <h1 class="business-name" style="font-size: 3em; margin-bottom: 20px;">${brandSettings.businessName}</h1>
                    <p style="font-size: 1.4em; margin-bottom: 30px;">Capturing life's precious moments with artistic vision</p>
                    <button style="background: white; color: ${brandSettings.colors.primary}; border: none; padding: 15px 30px; border-radius: 8px; font-weight: bold; font-size: 18px;">View Portfolio</button>
                </div>`,
                
                gallery: `<div style="${customStyle} padding: 60px 20px;">
                    <h2 style="text-align: center; margin-bottom: 40px; color: ${brandSettings.colors.primary}; font-size: 2.5em;">Featured Work</h2>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; max-width: 1200px; margin: 0 auto;">
                        <div style="aspect-ratio: 1; background: linear-gradient(45deg, #ddd, #eee); border-radius: 8px; border: 3px solid ${brandSettings.colors.accent};"></div>
                        <div style="aspect-ratio: 1; background: linear-gradient(45deg, #ddd, #eee); border-radius: 8px; border: 3px solid ${brandSettings.colors.accent};"></div>
                        <div style="aspect-ratio: 1; background: linear-gradient(45deg, #ddd, #eee); border-radius: 8px; border: 3px solid ${brandSettings.colors.accent};"></div>
                        <div style="aspect-ratio: 1; background: linear-gradient(45deg, #ddd, #eee); border-radius: 8px; border: 3px solid ${brandSettings.colors.accent};"></div>
                        <div style="aspect-ratio: 1; background: linear-gradient(45deg, #ddd, #eee); border-radius: 8px; border: 3px solid ${brandSettings.colors.accent};"></div>
                        <div style="aspect-ratio: 1; background: linear-gradient(45deg, #ddd, #eee); border-radius: 8px; border: 3px solid ${brandSettings.colors.accent};"></div>
                    </div>
                </div>`,
                
                about: `<div style="${customStyle} padding: 80px 20px;">
                    <div style="max-width: 800px; margin: 0 auto; text-align: center;">
                        <h2 style="color: ${brandSettings.colors.primary}; font-size: 2.5em; margin-bottom: 30px;">About <span class="business-name">${brandSettings.businessName}</span></h2>
                        <p style="font-size: 1.3em; line-height: 1.8; color: ${brandSettings.colors.text};">We specialize in capturing the authentic emotions and beautiful moments that make your story unique. With over 10 years of experience, we bring artistic vision and technical expertise to every session, creating timeless memories that you'll treasure forever.</p>
                    </div>
                </div>`,
                
                services: `<div style="${customStyle} padding: 80px 20px;">
                    <h2 style="text-align: center; margin-bottom: 50px; font-size: 2.5em;">Our Services</h2>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 40px; max-width: 1000px; margin: 0 auto;">
                        <div style="text-align: center; padding: 40px 20px;">
                            <h3 style="font-size: 1.8em; margin-bottom: 15px;">Wedding Photography</h3>
                            <p style="font-size: 1.1em; line-height: 1.6;">Capturing your special day with elegance and emotion</p>
                        </div>
                        <div style="text-align: center; padding: 40px 20px;">
                            <h3 style="font-size: 1.8em; margin-bottom: 15px;">Portrait Sessions</h3>
                            <p style="font-size: 1.1em; line-height: 1.6;">Professional headshots and family portraits</p>
                        </div>
                        <div style="text-align: center; padding: 40px 20px;">
                            <h3 style="font-size: 1.8em; margin-bottom: 15px;">Event Photography</h3>
                            <p style="font-size: 1.1em; line-height: 1.6;">Corporate events and special celebrations</p>
                        </div>
                    </div>
                </div>`,
                
                contact: `<div style="${customStyle} padding: 80px 20px;">
                    <div style="max-width: 600px; margin: 0 auto;">
                        <h2 style="text-align: center; margin-bottom: 40px; font-size: 2.5em;">Contact <span class="business-name">${brandSettings.businessName}</span></h2>
                        <div style="display: grid; gap: 20px;">
                            <input type="text" placeholder="Your Name" style="padding: 18px; border: none; border-radius: 8px; font-size: 16px;">
                            <input type="email" placeholder="Your Email" style="padding: 18px; border: none; border-radius: 8px; font-size: 16px;">
                            <textarea placeholder="Tell us about your photography needs..." rows="6" style="padding: 18px; border: none; border-radius: 8px; font-size: 16px; resize: vertical;"></textarea>
                            <button style="background: ${brandSettings.colors.accent}; color: white; border: none; padding: 18px 30px; border-radius: 8px; font-weight: bold; font-size: 18px; cursor: pointer;">Send Message</button>
                        </div>
                    </div>
                </div>`,

                // Custom Legacy Elite Components
                'legacy-hero': `<div style="${customStyle} padding: 120px 20px; text-align: center; position: relative; overflow: hidden; background-image: linear-gradient(rgba(15, 15, 15, 0.8), rgba(26, 26, 26, 0.9)), url('https://images-pw.pixieset.com/elementfield/na3yK1b/DSC_3189-e16d3c7e-1500.jpg'); background-size: cover; background-position: center; background-attachment: fixed;">
                    <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: radial-gradient(circle at 30% 30%, rgba(212, 175, 55, 0.1) 0%, transparent 70%); pointer-events: none;"></div>
                    <div style="position: relative; z-index: 1;">
                        <div class="logo-placeholder" style="margin-bottom: 40px; display: flex; justify-content: center;">
                            <img src="attached_assets/logo_1753330290399.png" style="height: 200px; width: auto; filter: drop-shadow(0 12px 24px rgba(0,0,0,0.9)) drop-shadow(0 0 30px rgba(212,175,55,0.4)) drop-shadow(0 0 60px rgba(212,175,55,0.2));">
                        </div>
                        <h2 style="font-size: 2.2em; margin-bottom: 20px; color: #f4e4bc; font-weight: 300; font-style: italic; text-shadow: 2px 2px 4px rgba(0,0,0,0.7);">Lance Casselman</h2>
                        <p style="font-size: 1.4em; margin-bottom: 40px; color: rgba(244, 228, 188, 0.95); max-width: 600px; margin-left: auto; margin-right: auto; line-height: 1.6; text-shadow: 1px 1px 3px rgba(0,0,0,0.8);">"Your Life, Your Legacy, Perfectly Captured!"</p>
                        <div style="display: flex; gap: 20px; justify-content: center; flex-wrap: wrap;">
                            <button onclick="scrollToGallery()" style="background: linear-gradient(135deg, #d4af37 0%, #f4e4bc 100%); color: #1a1a1a; border: none; padding: 18px 35px; border-radius: 8px; font-weight: bold; font-size: 18px; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 6px 20px rgba(212, 175, 55, 0.3); transform: perspective(1000px) rotateX(0deg); animation: float 3s ease-in-out infinite;">View Portfolio</button>
                            <a href="sms:8434851315?&body=Hi Lance! I found your website and I'm blown away by your photography. I'd love to discuss booking a session!" style="background: rgba(26, 26, 26, 0.8); color: #d4af37; border: 2px solid #d4af37; padding: 16px 33px; border-radius: 8px; font-weight: bold; font-size: 18px; cursor: pointer; transition: all 0.3s ease; backdrop-filter: blur(10px); text-decoration: none; display: inline-block; animation: pulse-glow 2s ease-in-out infinite alternate;">ðŸ“± Text: 843-485-1315</a>
                        </div>
                        
                        <!-- FLOATING PARTICLES ANIMATION -->
                        <div class="floating-particles" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; pointer-events: none; overflow: hidden;">
                            <div style="position: absolute; width: 4px; height: 4px; background: #d4af37; border-radius: 50%; opacity: 0.6; animation: float-particle 8s linear infinite; top: 20%; left: 10%;"></div>
                            <div style="position: absolute; width: 6px; height: 6px; background: #f4e4bc; border-radius: 50%; opacity: 0.4; animation: float-particle 12s linear infinite; top: 60%; left: 80%; animation-delay: -2s;"></div>
                            <div style="position: absolute; width: 3px; height: 3px; background: #d4af37; border-radius: 50%; opacity: 0.7; animation: float-particle 10s linear infinite; top: 40%; left: 30%; animation-delay: -5s;"></div>
                            <div style="position: absolute; width: 5px; height: 5px; background: #f4e4bc; border-radius: 50%; opacity: 0.5; animation: float-particle 15s linear infinite; top: 80%; left: 60%; animation-delay: -8s;"></div>
                        </div>
                    </div>
                </div>`,

                'legacy-philosophy': `<div style="${customStyle} padding: 100px 20px; position: relative; overflow: hidden;">
                    <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background-image: url('https://images-pw.pixieset.com/elementfield/GG3m0E3/20240716184620-DSC_6267-111f5677-1500.jpg'); background-size: cover; background-position: center; opacity: 0.15; background-attachment: fixed;"></div>
                    <div style="position: relative; z-index: 1; max-width: 1000px; margin: 0 auto; text-align: center;">
                        <h2 style="color: #d4af37; font-size: 3em; margin-bottom: 40px; font-family: 'Playfair Display', serif; font-weight: 400; font-style: italic; text-shadow: 2px 2px 4px rgba(0,0,0,0.8);">Capturing Unforgettable South Carolina Moments</h2>
                        <div style="font-size: 1.4em; line-height: 1.8; color: #f4e4bc; margin-bottom: 40px;">
                            <p style="margin-bottom: 25px; font-style: italic; text-shadow: 1px 1px 3px rgba(0,0,0,0.7);">"Time doesn't wait... We blink and the kids are grown... We laugh and the moment slips away..."</p>
                            <p style="margin-bottom: 25px; color: #d4af37; font-weight: 500; text-shadow: 2px 2px 4px rgba(0,0,0,0.8); font-size: 1.2em;">"But through photography, we get to hold on."</p>
                            <p style="margin-bottom: 25px; text-shadow: 1px 1px 3px rgba(0,0,0,0.7);">I created this brand to honor that ideaâ€”to give families, couples, and individuals a way to capture life exactly as it isâ€¦ and to make sure it lives on.</p>
                            <p style="color: #d4af37; font-weight: 500; font-size: 1.2em; text-shadow: 2px 2px 4px rgba(0,0,0,0.8); padding: 20px; background: rgba(0,0,0,0.3); border-radius: 12px; backdrop-filter: blur(10px);">"You bring your story, your people, your loveâ€”I bring the lens, the light, and the vision to preserve it forever. Together, we create something timeless."</p>
                        </div>
                    </div>
                </div>`,

                'legacy-gallery': `<div style="${customStyle} padding: 100px 20px;">
                    <h2 style="text-align: center; margin-bottom: 60px; color: #d4af37; font-size: 3em; font-family: 'Playfair Display', serif; font-weight: 400;">Featured Work</h2>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px; max-width: 1200px; margin: 0 auto;">
                        <div onclick="openLightbox('https://images-pw.pixieset.com/elementfield/na3yK1b/DSC_3189-e16d3c7e-1500.jpg', 'Dramatic portrait with stunning architectural elements and cinematic lighting - captured during a Charleston session')" style="aspect-ratio: 4/5; background-image: url('https://images-pw.pixieset.com/elementfield/na3yK1b/DSC_3189-e16d3c7e-1500.jpg'); background-size: cover; background-position: center; border-radius: 12px; border: 3px solid #d4af37; position: relative; overflow: hidden; cursor: pointer; transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); transform: perspective(1000px) rotateX(0deg);" onmouseover="this.style.transform='perspective(1000px) rotateX(-8deg) rotateY(-5deg) scale(1.08)'; this.style.boxShadow='0 25px 50px rgba(212,175,55,0.6), 0 15px 30px rgba(0,0,0,0.4)'" onmouseout="this.style.transform='perspective(1000px) rotateX(0deg) rotateY(0deg) scale(1)'; this.style.boxShadow='none'">
                            <div style="position: absolute; top: 15px; right: 15px; background: linear-gradient(135deg, #d4af37, #f4e4bc); color: #1a1a1a; padding: 8px 12px; border-radius: 20px; font-size: 0.8em; font-weight: bold; box-shadow: 0 4px 12px rgba(0,0,0,0.3);">âœ¨ Featured</div>
                            <div style="position: absolute; bottom: 15px; left: 15px; color: white; font-weight: bold; background: rgba(0,0,0,0.85); padding: 10px 15px; border-radius: 8px; backdrop-filter: blur(10px); border: 1px solid rgba(212,175,55,0.3);">Dramatic Portraits</div>
                        </div>
                        <div onclick="openLightbox('https://images-pw.pixiuset.com/elementfield/GG3m0E3/20240716184620-DSC_6267-111f5677-1500.jpg', 'Breathtaking beach silhouette at golden hour with dramatic sky - the magic of Myrtle Beach sunsets')" style="aspect-ratio: 4/5; background-image: url('https://images-pw.pixiuset.com/elementfield/GG3m0E3/20240716184620-DSC_6267-111f5677-1500.jpg'); background-size: cover; background-position: center; border-radius: 12px; border: 3px solid #d4af37; position: relative; overflow: hidden; cursor: pointer; transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); transform: perspective(1000px) rotateX(0deg);" onmouseover="this.style.transform='perspective(1000px) rotateX(-8deg) rotateY(5deg) scale(1.08)'; this.style.boxShadow='0 25px 50px rgba(212,175,55,0.6), 0 15px 30px rgba(0,0,0,0.4)';" onmouseout="this.style.transform='perspective(1000px) rotateX(0deg) rotateY(0deg) scale(1)'; this.style.boxShadow='none'">
                            <div style="position: absolute; bottom: 15px; left: 15px; color: white; font-weight: bold; background: rgba(0,0,0,0.85); padding: 10px 15px; border-radius: 8px; backdrop-filter: blur(10px); border: 1px solid rgba(212,175,55,0.3);">Beach Silhouettes</div>
                        </div>
                        <div onclick="openLightbox('https://images-pw.pixiuset.com/elementfield/ovnXqmk/DSC_0179-935598a7-1500.jpg', 'Beautiful Myrtle Beach photography session with natural lighting and genuine emotion captured')" style="aspect-ratio: 4/5; background-image: url('https://images-pw.pixiuset.com/elementfield/ovnXqmk/DSC_0179-935598a7-1500.jpg'); background-size: cover; background-position: center; border-radius: 12px; border: 3px solid #d4af37; position: relative; overflow: hidden; cursor: pointer; transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); transform: perspective(1000px) rotateX(0deg);" onmouseover="this.style.transform='perspective(1000px) rotateX(-8deg) rotateY(-5deg) scale(1.08)'; this.style.boxShadow='0 25px 50px rgba(212,175,55,0.6), 0 15px 30px rgba(0,0,0,0.4)'" onmouseout="this.style.transform='perspective(1000px) rotateX(0deg) rotateY(0deg) scale(1)'; this.style.boxShadow='none'">
                            <div style="position: absolute; bottom: 15px; left: 15px; color: white; font-weight: bold; background: rgba(0,0,0,0.85); padding: 10px 15px; border-radius: 8px; backdrop-filter: blur(10px); border: 1px solid rgba(212,175,55,0.3);">Myrtle Beach Sessions</div>
                        </div>
                        <div onclick="openLightbox('https://images-pw.pixiuset.com/elementfield/M5P7qxd/DSC_2077-37d27fdd-1500.jpg', 'Heartwarming family portrait capturing genuine emotions, connections, and the love that binds us together')" style="aspect-ratio: 4/5; background-image: url('https://images-pw.pixiuset.com/elementfield/M5P7qxd/DSC_2077-37d27fdd-1500.jpg'); background-size: cover; background-position: center; border-radius: 12px; border: 3px solid #d4af37; position: relative; overflow: hidden; cursor: pointer; transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); transform: perspective(1000px) rotateX(0deg);" onmouseover="this.style.transform='perspective(1000px) rotateX(-8deg) rotateY(5deg) scale(1.08)'; this.style.boxShadow='0 25px 50px rgba(212,175,55,0.6), 0 15px 30px rgba(0,0,0,0.4)'" onmouseout="this.style.transform='perspective(1000px) rotateX(0deg) rotateY(0deg) scale(1)'; this.style.boxShadow='none'">
                            <div style="position: absolute; bottom: 15px; left: 15px; color: white; font-weight: bold; background: rgba(0,0,0,0.85); padding: 10px 15px; border-radius: 8px; backdrop-filter: blur(10px); border: 1px solid rgba(212,175,55,0.3);">Family Moments</div>
                        </div>
                        <div onclick="openLightbox('https://images-pw.pixieset.com/elementfield/na3yK1b/DSC_3189-e16d3c7e-1500.jpg', 'Stunning Charleston architecture providing the perfect historic backdrop for timeless portraits')" style="aspect-ratio: 4/5; background-image: url('https://images-pw.pixieset.com/elementfield/na3yK1b/DSC_3189-e16d3c7e-1500.jpg'); background-size: cover; background-position: top; border-radius: 12px; border: 3px solid #d4af37; position: relative; overflow: hidden; cursor: pointer; transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); transform: perspective(1000px) rotateX(0deg);" onmouseover="this.style.transform='perspective(1000px) rotateX(-8deg) rotateY(-5deg) scale(1.08)'; this.style.boxShadow='0 25px 50px rgba(212,175,55,0.6), 0 15px 30px rgba(0,0,0,0.4)'" onmouseout="this.style.transform='perspective(1000px) rotateX(0deg) rotateY(0deg) scale(1)'; this.style.boxShadow='none'">
                            <div style="position: absolute; bottom: 15px; left: 15px; color: white; font-weight: bold; background: rgba(0,0,0,0.85); padding: 10px 15px; border-radius: 8px; backdrop-filter: blur(10px); border: 1px solid rgba(212,175,55,0.3);">Charleston Architecture</div>
                        </div>
                        <div style="aspect-ratio: 4/5; background: linear-gradient(135deg, #8b7355 0%, #d4af37 50%, #f4e4bc 100%); border-radius: 12px; border: 3px solid #d4af37; position: relative; overflow: hidden; display: flex; align-items: center; justify-content: center; color: #1a1a1a; font-size: 1.2em; text-align: center; font-family: 'Playfair Display', serif; cursor: pointer; transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);" onclick="window.open('sms:8434851315?&body=Hi Lance! I absolutely love your photography style and would like to book a session. When are you available?', '_self')" onmouseover="this.style.transform='scale(1.1) rotate(3deg)'; this.style.boxShadow='0 20px 40px rgba(212,175,55,0.4)'" onmouseout="this.style.transform='scale(1) rotate(0deg)'; this.style.boxShadow='none'">
                            <div style="background: rgba(255,255,255,0.95); padding: 25px; border-radius: 12px; backdrop-filter: blur(15px); box-shadow: 0 8px 32px rgba(0,0,0,0.1); animation: pulse-invite 3s ease-in-out infinite;">
                                <div style="font-size: 2.5em; margin-bottom: 15px; animation: bounce 2s ease-in-out infinite; color: #d4af37;">â—</div>
                                <div style="font-weight: bold; margin-bottom: 10px; font-size: 1.1em;">Book Your Session</div>
                                <div style="font-size: 0.9em; opacity: 0.8; color: #8b7355;">Tap to Get Started</div>
                            </div>
                        </div>
                    </div>
                    <div style="text-align: center; margin-top: 50px;">
                        <button style="background: linear-gradient(135deg, #d4af37 0%, #f4e4bc 100%); color: #1a1a1a; border: none; padding: 18px 35px; border-radius: 8px; font-weight: bold; font-size: 18px; cursor: pointer;">View Complete Portfolio</button>
                    </div>
                </div>`,

                'legacy-about': `<div style="${customStyle} padding: 100px 20px;">
                    <div style="max-width: 1000px; margin: 0 auto;">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 60px; align-items: center;">
                            <div>
                                <h2 style="color: #d4af37; font-size: 3em; margin-bottom: 30px; font-family: 'Playfair Display', serif; font-weight: 400;">My Goal For You</h2>
                                <p style="font-size: 1.3em; line-height: 1.8; color: #f4e4bc; margin-bottom: 25px;">My goal for you is more than just taking pictures â€” it's to create something that moves you every single time you look back.</p>
                                <p style="font-size: 1.3em; line-height: 1.8; color: #f4e4bc; margin-bottom: 25px;">I want you to feel proud, radiant, and seen. I want your photos to transport you back to those moments â€” the laughter, the love, the light in your eyes â€” with all the depth and emotion still intact.</p>
                                <p style="font-size: 1.3em; line-height: 1.8; color: #d4af37; font-weight: 500;">Because your story matters. And it deserves to be captured in a way that feels just as unforgettable as the moments themselves.</p>
                            </div>
                            <div style="background-image: url('https://images-pw.pixieset.com/elementfield/ovnXqmk/DSC_0179-935598a7-1500.jpg'); background-size: cover; background-position: center; aspect-ratio: 4/5; border-radius: 12px; border: 3px solid #d4af37; position: relative; overflow: hidden;">
                                <div style="position: absolute; bottom: 0; left: 0; right: 0; background: linear-gradient(transparent, rgba(0,0,0,0.8)); padding: 20px; text-align: center;">
                                    <p style="color: #d4af37; font-weight: bold; font-size: 1.1em; margin: 0;">South Carolina Coast</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>`,

                'legacy-contact': `<div style="${customStyle} padding: 100px 20px;">
                    <div style="max-width: 800px; margin: 0 auto; text-align: center;">
                        <h2 style="margin-bottom: 20px; font-size: 3em; font-family: 'Playfair Display', serif; font-weight: 400;">Ready to Capture Your Legacy?</h2>
                        <p style="font-size: 1.4em; margin-bottom: 50px; line-height: 1.6;">Call or Text 843-485-1315 or Submit a Message Below</p>
                        <div style="display: grid; gap: 20px; margin-bottom: 40px;">
                            <input id="contactName" type="text" placeholder="Your Name" style="padding: 20px; border: 2px solid #8b7355; border-radius: 8px; font-size: 16px; background: rgba(255,255,255,0.95); transition: all 0.3s ease;" onfocus="this.style.borderColor='#d4af37'; this.style.boxShadow='0 0 10px rgba(212,175,55,0.3)'" onblur="this.style.borderColor='#8b7355'; this.style.boxShadow='none'">
                            <input id="contactEmail" type="email" placeholder="Your Email" style="padding: 20px; border: 2px solid #8b7355; border-radius: 8px; font-size: 16px; background: rgba(255,255,255,0.95); transition: all 0.3s ease;" onfocus="this.style.borderColor='#d4af37'; this.style.boxShadow='0 0 10px rgba(212,175,55,0.3)'" onblur="this.style.borderColor='#8b7355'; this.style.boxShadow='none'">
                            <input id="contactPhone" type="tel" placeholder="Your Phone Number (optional)" style="padding: 20px; border: 2px solid #8b7355; border-radius: 8px; font-size: 16px; background: rgba(255,255,255,0.95); transition: all 0.3s ease;" onfocus="this.style.borderColor='#d4af37'; this.style.boxShadow='0 0 10px rgba(212,175,55,0.3)'" onblur="this.style.borderColor='#8b7355'; this.style.boxShadow='none'">
                            <textarea id="contactMessage" placeholder="Tell me about your photography vision..." rows="6" style="padding: 20px; border: 2px solid #8b7355; border-radius: 8px; font-size: 16px; resize: vertical; background: rgba(255,255,255,0.95); transition: all 0.3s ease;" onfocus="this.style.borderColor='#d4af37'; this.style.boxShadow='0 0 10px rgba(212,175,55,0.3)'" onblur="this.style.borderColor='#8b7355'; this.style.boxShadow='none'"></textarea>
                            <button onclick="sendContactEmail()" style="background: linear-gradient(135deg, #d4af37 0%, #f4e4bc 100%); color: #1a1a1a; border: none; padding: 20px 35px; border-radius: 8px; font-weight: bold; font-size: 18px; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(212,175,55,0.3);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 25px rgba(212,175,55,0.4)'" onmouseout="this.style.transform='translateY(0px)'; this.style.boxShadow='0 4px 15px rgba(212,175,55,0.3)'">Send Email</button>
                        </div>
                        <div style="display: flex; gap: 20px; justify-content: center; flex-wrap: wrap; margin-top: 30px;">
                            <a href="sms:8434851315?&body=Hi Lance! I'm interested in booking a photo session with The Legacy Photography. I found your website and love your style! When are you available?" style="background: rgba(26, 26, 26, 0.8); color: #d4af37; border: 2px solid #d4af37; padding: 15px 30px; border-radius: 8px; font-weight: bold; text-decoration: none; display: inline-block; backdrop-filter: blur(10px); transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(0,0,0,0.3);" onmouseover="this.style.background='#d4af37'; this.style.color='#1a1a1a'; this.style.transform='translateY(-2px)'" onmouseout="this.style.background='rgba(26, 26, 26, 0.8)'; this.style.color='#d4af37'; this.style.transform='translateY(0px)'">Text Message</a>
                            <a href="tel:8434851315" style="background: rgba(26, 26, 26, 0.8); color: #d4af37; border: 2px solid #d4af37; padding: 15px 30px; border-radius: 8px; font-weight: bold; text-decoration: none; display: inline-block; backdrop-filter: blur(10px); transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(0,0,0,0.3);" onmouseover="this.style.background='#d4af37'; this.style.color='#1a1a1a'; this.style.transform='translateY(-2px)'" onmouseout="this.style.background='rgba(26, 26, 26, 0.8)'; this.style.color='#d4af37'; this.style.transform='translateY(0px)'">Call Direct</a>
                            <button onclick="sendQuickText()" style="background: rgba(26, 26, 26, 0.8); color: #d4af37; border: 2px solid #d4af37; padding: 15px 30px; border-radius: 8px; font-weight: bold; cursor: pointer; backdrop-filter: blur(10px); transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(0,0,0,0.3);" onmouseover="this.style.background='#d4af37'; this.style.color='#1a1a1a'; this.style.transform='translateY(-2px)'" onmouseout="this.style.background='rgba(26, 26, 26, 0.8)'; this.style.color='#d4af37'; this.style.transform='translateY(0px)'">Quick Booking</button>
                        </div>
                    </div>
                </div>`,

                // NEW MIND-BLOWING COMPONENTS
                'legacy-testimonials': `<div style="${customStyle} padding: 100px 20px;">
                    <div style="max-width: 1200px; margin: 0 auto; text-align: center;">
                        <h2 style="color: #1a1a1a; font-size: 3em; margin-bottom: 60px; font-family: 'Playfair Display', serif; font-weight: 400; text-shadow: 1px 1px 2px rgba(255,255,255,0.3);">What Clients Say</h2>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 40px;">
                            <div style="background: rgba(26, 26, 26, 0.9); padding: 40px; border-radius: 16px; border: 2px solid rgba(212, 175, 55, 0.3); backdrop-filter: blur(10px); position: relative;">
                                <div style="position: absolute; top: -15px; left: 40px; background: #d4af37; color: #1a1a1a; padding: 8px 16px; border-radius: 20px; font-weight: bold; font-size: 0.9em;">â­â­â­â­â­</div>
                                <p style="color: #f4e4bc; font-size: 1.2em; font-style: italic; line-height: 1.6; margin-bottom: 25px;">"Lance captured our family perfectly! The photos are absolutely stunning and we treasure them every day. His artistic vision is incredible."</p>
                                <div style="color: #d4af37; font-weight: bold;">â€” Sarah & Mike Johnson</div>
                                <div style="color: rgba(244, 228, 188, 0.7); font-size: 0.9em;">Family Portrait Session</div>
                            </div>
                            <div style="background: rgba(26, 26, 26, 0.9); padding: 40px; border-radius: 16px; border: 2px solid rgba(212, 175, 55, 0.3); backdrop-filter: blur(10px); position: relative;">
                                <div style="position: absolute; top: -15px; left: 40px; background: #d4af37; color: #1a1a1a; padding: 8px 16px; border-radius: 20px; font-weight: bold; font-size: 0.9em;">â­â­â­â­â­</div>
                                <p style="color: #f4e4bc; font-size: 1.2em; font-style: italic; line-height: 1.6; margin-bottom: 25px;">"Our wedding photos are pure magic! Lance has an incredible eye for capturing those perfect, emotional moments that tell our love story."</p>
                                <div style="color: #d4af37; font-weight: bold;">â€” Jennifer & David Chen</div>
                                <div style="color: rgba(244, 228, 188, 0.7); font-size: 0.9em;">Wedding Photography</div>
                            </div>
                            <div style="background: rgba(26, 26, 26, 0.9); padding: 40px; border-radius: 16px; border: 2px solid rgba(212, 175, 55, 0.3); backdrop-filter: blur(10px); position: relative;">
                                <div style="position: absolute; top: -15px; left: 40px; background: #d4af37; color: #1a1a1a; padding: 8px 16px; border-radius: 20px; font-weight: bold; font-size: 0.9em;">â­â­â­â­â­</div>
                                <p style="color: #f4e4bc; font-size: 1.2em; font-style: italic; line-height: 1.6; margin-bottom: 25px;">"The beach session was amazing! Lance made us feel so comfortable and the sunset photos are absolutely breathtaking. Pure artistry!"</p>
                                <div style="color: #d4af37; font-weight: bold;">â€” Amanda Rodriguez</div>
                                <div style="color: rgba(244, 228, 188, 0.7); font-size: 0.9em;">Senior Portrait Session</div>
                            </div>
                        </div>
                    </div>
                </div>`,

                'legacy-services': `<div style="${customStyle} padding: 100px 20px; position: relative; overflow: hidden;">
                    <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background-image: url('https://images-pw.pixieset.com/elementfield/M5P7qxd/DSC_2077-37d27fdd-1500.jpg'); background-size: cover; background-position: center; opacity: 0.1; background-attachment: fixed;"></div>
                    <div style="position: relative; z-index: 1; max-width: 1200px; margin: 0 auto;">
                        <h2 style="text-align: center; margin-bottom: 60px; color: #d4af37; font-size: 3em; font-family: 'Playfair Display', serif; font-weight: 400; text-shadow: 2px 2px 4px rgba(0,0,0,0.8);">Photography Services</h2>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 40px;">
                            <div style="background: rgba(139, 115, 85, 0.9); padding: 40px; border-radius: 16px; text-align: center; border: 3px solid #d4af37; backdrop-filter: blur(10px); transition: transform 0.3s ease;">
                                <div style="font-size: 3em; margin-bottom: 20px;">ðŸ’’</div>
                                <h3 style="color: #d4af37; font-size: 1.8em; margin-bottom: 15px; font-family: 'Playfair Display', serif;">Wedding Photography</h3>
                                <p style="color: #f4e4bc; font-size: 1.1em; line-height: 1.6; margin-bottom: 20px;">Capture your special day with elegance and emotion. From intimate ceremonies to grand celebrations.</p>
                                <div style="color: #d4af37; font-weight: bold; font-size: 1.3em;">Starting at $2,500</div>
                            </div>
                            <div style="background: rgba(139, 115, 85, 0.9); padding: 40px; border-radius: 16px; text-align: center; border: 3px solid #d4af37; backdrop-filter: blur(10px); transition: transform 0.3s ease;">
                                <div style="font-size: 3em; margin-bottom: 20px;">ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦</div>
                                <h3 style="color: #d4af37; font-size: 1.8em; margin-bottom: 15px; font-family: 'Playfair Display', serif;">Family Portraits</h3>
                                <p style="color: #f4e4bc; font-size: 1.1em; line-height: 1.6; margin-bottom: 20px;">Beautiful family moments that become treasured memories. Beach, park, or studio sessions available.</p>
                                <div style="color: #d4af37; font-weight: bold; font-size: 1.3em;">Starting at $450</div>
                            </div>
                            <div style="background: rgba(139, 115, 85, 0.9); padding: 40px; border-radius: 16px; text-align: center; border: 3px solid #d4af37; backdrop-filter: blur(10px); transition: transform 0.3s ease;">
                                <div style="font-size: 3em; margin-bottom: 20px;">ðŸ–ï¸</div>
                                <h3 style="color: #d4af37; font-size: 1.8em; margin-bottom: 15px; font-family: 'Playfair Display', serif;">Beach Sessions</h3>
                                <p style="color: #f4e4bc; font-size: 1.1em; line-height: 1.6; margin-bottom: 20px;">Stunning Myrtle Beach and Charleston coast photography with golden hour lighting and ocean backdrops.</p>
                                <div style="color: #d4af37; font-weight: bold; font-size: 1.3em;">Starting at $350</div>
                            </div>
                            <div style="background: rgba(139, 115, 85, 0.9); padding: 40px; border-radius: 16px; text-align: center; border: 3px solid #d4af37; backdrop-filter: blur(10px); transition: transform 0.3s ease;">
                                <div style="font-size: 3em; margin-bottom: 20px;">ðŸŽ“</div>
                                <h3 style="color: #d4af37; font-size: 1.8em; margin-bottom: 15px; font-family: 'Playfair Display', serif;">Senior Portraits</h3>
                                <p style="color: #f4e4bc; font-size: 1.1em; line-height: 1.6; margin-bottom: 20px;">Celebrate this milestone with professional senior portraits that showcase personality and achievement.</p>
                                <div style="color: #d4af37; font-weight: bold; font-size: 1.3em;">Starting at $400</div>
                            </div>
                        </div>
                        <div style="text-align: center; margin-top: 60px;">
                            <a href="sms:8434851315?&body=Hi! I'd like to discuss photography services and get a custom quote." style="background: linear-gradient(135deg, #d4af37 0%, #f4e4bc 100%); color: #1a1a1a; text-decoration: none; padding: 20px 40px; border-radius: 12px; font-weight: bold; font-size: 1.2em; display: inline-block; box-shadow: 0 8px 25px rgba(212, 175, 55, 0.4); transition: all 0.3s ease;">ðŸ“± Get Custom Quote</a>
                        </div>
                    </div>
                </div>`
            };
            
            element.innerHTML = components[type] || '';
            
            // Add click handler for selection
            element.addEventListener('click', (e) => {
                e.stopPropagation();
                selectElement(element);
            });
            
            // Add to canvas
            const websiteContent = document.getElementById('websiteContent');
            websiteContent.appendChild(element);
        }

        // Branding Functions
        function uploadLogo(input) {
            const file = input.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    brandSettings.logo = e.target.result;
                    
                    // Show logo preview
                    const preview = document.getElementById('logoPreview');
                    preview.innerHTML = `<img src="${e.target.result}" style="max-width: 100%; max-height: 60px; border-radius: 4px;">`;
                    
                    // Update all logo instances on the website
                    updateLogosOnWebsite();
                    
                    console.log('Logo uploaded and applied to website');
                };
                reader.readAsDataURL(file);
            }
        }

        function updateBusinessName() {
            const name = document.getElementById('businessName').value;
            brandSettings.businessName = name;
            
            // Update all business name instances
            const elements = document.querySelectorAll('.business-name');
            elements.forEach(el => {
                el.textContent = name;
            });
            
            console.log(`Business name updated to: ${name}`);
        }

        function changePrimaryFont(fontFamily) {
            brandSettings.primaryFont = fontFamily;
            
            const fontMap = {
                'system': '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
                'serif': 'Georgia, "Times New Roman", serif',
                'playfair': '"Playfair Display", serif',
                'lora': '"Lora", serif',
                'crimson': '"Crimson Text", serif',
                'modern': '"Helvetica Neue", Helvetica, Arial, sans-serif',
                'montserrat': '"Montserrat", sans-serif',
                'opensans': '"Open Sans", sans-serif',
                'roboto': '"Roboto", sans-serif'
            };
            
            // Load Google Fonts if needed
            if (['playfair', 'lora', 'crimson', 'montserrat', 'opensans', 'roboto'].includes(fontFamily)) {
                loadGoogleFont(fontFamily);
            }
            
            // Apply font to website
            const websiteContent = document.getElementById('websiteContent');
            if (websiteContent) {
                websiteContent.style.fontFamily = fontMap[fontFamily];
            }
            
            console.log(`ðŸ”¤ Font changed to: ${fontFamily}`);
        }

        // Initialize website builder when tab is opened
        function initializeWebsiteBuilder() {
            console.log('Initializing photography website builder...');
            
            // Load Playfair Display font for your template
            loadGoogleFont('playfair');
            
            // Set default business name to yours
            const businessNameInput = document.getElementById('businessName');
            if (businessNameInput) {
                businessNameInput.value = 'The Legacy Photography';
            }
            
            // Add revolutionary CSS animations to the page
            if (!document.getElementById('revolutionaryStyles')) {
                const revolutionaryCSS = document.createElement('style');
                revolutionaryCSS.id = 'revolutionaryStyles';
                revolutionaryCSS.innerHTML = `
                    /* MIND-BLOWING ANIMATIONS */
                    @keyframes float { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-12px); } }
                    @keyframes pulse-glow { 
                        0% { box-shadow: 0 0 5px rgba(212,175,55,0.3), 0 0 10px rgba(212,175,55,0.1); } 
                        100% { box-shadow: 0 0 25px rgba(212,175,55,0.8), 0 0 35px rgba(212,175,55,0.4), 0 0 45px rgba(212,175,55,0.2); } 
                    }
                    @keyframes float-particle { 
                        0% { transform: translateY(100vh) rotate(0deg); opacity: 0; } 
                        10% { opacity: 1; }
                        90% { opacity: 1; }
                        100% { transform: translateY(-100px) rotate(360deg); opacity: 0; } 
                    }
                    @keyframes bounce { 
                        0%, 100% { transform: translateY(0); } 
                        50% { transform: translateY(-10px); } 
                    }
                    @keyframes pulse-invite { 
                        0%, 100% { transform: scale(1) rotate(0deg); } 
                        50% { transform: scale(1.08) rotate(1deg); } 
                    }
                    @keyframes galleryBounce {
                        0% { transform: scale(1); }
                        30% { transform: scale(1.02); }
                        60% { transform: scale(0.98); }
                        100% { transform: scale(1); }
                    }
                    @keyframes shimmer {
                        0% { background-position: -200% 0; }
                        100% { background-position: 200% 0; }
                    }
                    @keyframes fadeInUp {
                        from { opacity: 0; transform: translateY(30px); }
                        to { opacity: 1; transform: translateY(0); }
                    }
                `;
                document.head.appendChild(revolutionaryCSS);
            }
        }

        function loadGoogleFont(font) {
            const fontUrls = {
                'playfair': 'https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&display=swap',
                'lora': 'https://fonts.googleapis.com/css2?family=Lora:wght@400;500;600&display=swap',
                'crimson': 'https://fonts.googleapis.com/css2?family=Crimson+Text:wght@400;600&display=swap',
                'montserrat': 'https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap',
                'opensans': 'https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;500;600;700&display=swap',
                'roboto': 'https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap'
            };
            
            if (!document.querySelector(`link[href="${fontUrls[font]}"]`)) {
                const link = document.createElement('link');
                link.href = fontUrls[font];
                link.rel = 'stylesheet';
                document.head.appendChild(link);
            }
        }

        function updateBrandColor(colorType, colorValue) {
            brandSettings.colors[colorType] = colorValue;
            
            // Apply color changes to website elements would go here
            console.log(`ðŸŽ¨ ${colorType} color updated to: ${colorValue}`);
        }

        function updateLogosOnWebsite() {
            if (!brandSettings.logo) return;
            
            // Find and update all logo placeholders
            const logoElements = document.querySelectorAll('.logo-placeholder');
            logoElements.forEach(el => {
                el.innerHTML = `<img src="${brandSettings.logo}" style="height: 60px; width: auto;">`;
            });
        }

        function getFontFamily() {
            const fontMap = {
                'system': '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
                'serif': 'Georgia, "Times New Roman", serif',
                'playfair': '"Playfair Display", serif',
                'lora': '"Lora", serif',
                'crimson': '"Crimson Text", serif',
                'modern': '"Helvetica Neue", Helvetica, Arial, sans-serif',
                'montserrat': '"Montserrat", sans-serif',
                'opensans': '"Open Sans", sans-serif',
                'roboto': '"Roboto", sans-serif'
            };
            return fontMap[brandSettings.primaryFont];
        }

        // AI Functions
        function generateAILayout() {
            console.log('ðŸ¤– AI generating optimal layout...');
            alert('AI suggests: Add testimonials section to build trust! This would increase conversions by 35%.');
        }

        function optimizeForMobile() {
            console.log('ðŸ“± AI optimizing for mobile devices...');
            alert('Mobile optimization complete! Your site now loads 40% faster on mobile devices.');
        }

        function suggestColors() {
            console.log('ðŸŽ¨ AI analyzing your photos for color palette...');
            const palettes = [
                'Deep Blues: #2C3E50, #3498DB, #ECF0F1',
                'Warm Earth: #8B4513, #D2691E, #F4A460', 
                'Modern Minimal: #2D3748, #4A5568, #E2E8F0'
            ];
            const palette = palettes[Math.floor(Math.random() * palettes.length)];
            alert(`AI suggests color palette: ${palette}`);
        }

        function generateContent() {
            console.log('âœï¸ AI writing professional photography content...');
            alert('AI generated professional content for your sections! Check your About section for enhanced copy.');
        }

        // Device Preview Functions
        function setDevicePreview(device) {
            const canvas = document.getElementById('websiteCanvas');
            const buttons = document.querySelectorAll('.device-btn');
            
            // Update button states
            buttons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Update canvas size
            canvas.className = 'website-canvas';
            if (device === 'mobile') {
                canvas.style.maxWidth = '375px';
                canvas.style.margin = '20px auto';
            } else if (device === 'tablet') {
                canvas.style.maxWidth = '768px';
                canvas.style.margin = '20px auto';
            } else {
                canvas.style.maxWidth = 'none';
                canvas.style.margin = '20px';
            }
            
            console.log(`ðŸ“± Switched to ${device} preview mode`);
        }

        // Drag and Drop Functions
        function allowDrop(e) {
            e.preventDefault();
        }

        function dropComponent(e) {
            e.preventDefault();
            const componentType = e.dataTransfer.getData('text/plain');
            if (componentType) {
                createTemplateComponent(componentType, 0, '');
                console.log(`${componentType} component added successfully!`);
            }
        }

        // Element Selection
        function selectElement(element) {
            // Remove previous selection
            if (selectedElement) {
                selectedElement.classList.remove('selected');
            }
            
            // Select new element
            selectedElement = element;
            element.classList.add('selected');
            
            // Show properties panel
            showPropertiesPanel(element);
        }

        function showPropertiesPanel(element) {
            const panel = document.getElementById('propertyPanel');
            panel.innerHTML = `
                <div>
                    <h4>Element Properties</h4>
                    <div style="margin: 15px 0;">
                        <label>Background Color:</label>
                        <input type="color" value="#667eea" onchange="updateElementStyle(this, 'backgroundColor')" style="width: 100%; height: 35px; border: none; border-radius: 4px; margin-top: 5px;">
                    </div>
                    <div style="margin: 15px 0;">
                        <label>Text Color:</label>
                        <input type="color" value="#333333" onchange="updateElementStyle(this, 'color')" style="width: 100%; height: 35px; border: none; border-radius: 4px; margin-top: 5px;">
                    </div>
                    <div style="margin: 15px 0;">
                        <label>Padding:</label>
                        <input type="range" min="0" max="100" value="20" onchange="updateElementStyle(this, 'padding', this.value + 'px')" style="width: 100%; margin-top: 5px;">
                    </div>
                    <button onclick="deleteElement()" style="background: rgba(0, 0, 0, 0.7); color: #ff6b6b; border: 1px solid rgba(255, 107, 107, 0.4); padding: 10px 15px; border-radius: 6px; cursor: pointer; width: 100%; margin-top: 15px;">
                        Delete Element
                    </button>
                </div>
            `;
        }

        function updateElementStyle(input, property, value) {
            if (selectedElement) {
                const actualValue = value || input.value;
                selectedElement.style[property] = actualValue;
            }
        }

        function deleteElement() {
            if (selectedElement) {
                selectedElement.remove();
                selectedElement = null;
                document.getElementById('propertyPanel').innerHTML = '<div class="no-selection"><p>Select an element to edit properties</p></div>';
                console.log('Element deleted successfully!');
            }
        }

        // Website Actions
        function previewWebsite() {
            console.log('ðŸ‘ï¸ Opening website preview...');
            
            // Get the website content
            const websiteContent = document.getElementById('websiteContent');
            if (!websiteContent || websiteContent.children.length === 0) {
                alert('Please select a template or add components first!');
                return;
            }
            
            // Create preview window
            const previewWindow = window.open('', '_blank', 'width=1200,height=800,scrollbars=yes,resizable=yes');
            
            // Get all the custom styles
            const builderStyles = `
                <style>
                    * { margin: 0; padding: 0; box-sizing: border-box; }
                    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; line-height: 1.6; }
                    .website-component { margin: 0; }
                    @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@300;400;500;600;700&display=swap');
                </style>
            `;
            
            previewWindow.document.write(`
                <!DOCTYPE html>
                <html lang="en">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>Website Preview - ${brandSettings.businessName}</title>
                    ${builderStyles}
                </head>
                <body>
                    ${websiteContent.innerHTML}
                </body>
                </html>
            `);
            
            previewWindow.document.close();
            console.log('Website preview opened in new window');
        }

        function publishWebsite() {
            console.log('Publishing website...');
            
            const websiteContent = document.getElementById('websiteContent');
            if (!websiteContent || websiteContent.children.length === 0) {
                alert('Please create a website first by selecting a template or adding components!');
                return;
            }
            
            // In a real implementation, this would save to a server
            alert('Website published successfully! Your site would now be live at your custom domain.');
            console.log('Website published successfully');
        }

        // Setup drag and drop for components
        document.addEventListener('DOMContentLoaded', function() {
            const components = document.querySelectorAll('.component-item');
            components.forEach(component => {
                component.addEventListener('dragstart', (e) => {
                    e.dataTransfer.setData('text/plain', e.target.dataset.component);
                });
            });
        });

        // Add website component selection styles
        const websiteBuilderStyles = `
            .website-component.selected {
                outline: 2px solid #667eea !important;
                outline-offset: 2px;
            }
            
            .website-component {
                cursor: pointer;
                transition: all 0.2s ease;
            }
            
            .website-component:hover {
                transform: scale(1.02);
                box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            }
            
            .element-enter {
                animation: elementEnter 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            }
            
            @keyframes elementEnter {
                0% {
                    opacity: 0;
                    transform: scale(0.8) translateY(-20px);
                }
                100% {
                    opacity: 1;
                    transform: scale(1) translateY(0);
                }
            }
        `;
        
        // Inject styles
        const styleSheet = document.createElement('style');
        styleSheet.textContent = websiteBuilderStyles;
        document.head.appendChild(styleSheet);

    </script>

        </div> <!-- End Client Management Tab -->

        <!-- Website Builder Tab Content -->
        <div id="websitesTab" class="tab-content">
            <div class="revolutionary-website-builder">
                <!-- Builder Mode Header -->
                <div class="builder-mode-header">
                    <div class="builder-mode-switch">
                        <button class="mode-btn active" onclick="switchBuilderMode('template')" id="templateModeBtn">Quick Templates</button>
                        <button class="mode-btn" onclick="switchBuilderMode('custom')" id="customModeBtn">Custom Builder</button>
                    </div>
                    <div class="builder-actions">
                        <button class="action-btn" onclick="previewWebsite()">Preview</button>
                        <button class="action-btn primary" onclick="publishWebsite()">Publish</button>
                    </div>
                </div>

                <!-- Template Gallery Mode -->
                <div id="templateGalleryMode" class="template-gallery-mode active">
                    <div class="template-hero">
                        <h2>Quick Start Templates</h2>
                        <p>Professional photography websites ready in 30 seconds</p>
                    </div>
                    
                    <div class="template-grid">
                        <div class="template-card" onclick="useTemplate('legacy')">
                            <div class="template-preview legacy-preview">
                                <div class="preview-header">The Legacy Photography</div>
                                <div class="preview-hero">Capturing Timeless Moments</div>
                                <div class="preview-gallery">
                                    <div class="preview-photo"></div>
                                    <div class="preview-photo"></div>
                                    <div class="preview-photo"></div>
                                </div>
                            </div>
                            <div class="template-info">
                                <h3>Legacy Style</h3>
                                <p>Dark elegant theme with gold accents, perfect for luxury photography brands</p>
                                <div class="template-features">
                                    <span class="feature-tag">Hero Section</span>
                                    <span class="feature-tag">Portfolio Grid</span>
                                    <span class="feature-tag">Contact Form</span>
                                    <span class="feature-tag">About Page</span>
                                </div>
                                <button class="use-template-btn">Use This Template</button>
                            </div>
                        </div>

                        <div class="template-card" onclick="useTemplate('modern')">
                            <div class="template-preview modern-preview">
                                <div class="preview-header">Modern Photography</div>
                                <div class="preview-hero">Creative Visual Stories</div>
                                <div class="preview-gallery">
                                    <div class="preview-photo"></div>
                                    <div class="preview-photo"></div>
                                    <div class="preview-photo"></div>
                                </div>
                            </div>
                            <div class="template-info">
                                <h3>Modern Portfolio</h3>
                                <p>Clean contemporary design with gradient overlays and responsive grids</p>
                                <div class="template-features">
                                    <span class="feature-tag">Animated Hero</span>
                                    <span class="feature-tag">Gallery Lightbox</span>
                                    <span class="feature-tag">Testimonials</span>
                                    <span class="feature-tag">Pricing Table</span>
                                </div>
                                <button class="use-template-btn">Use This Template</button>
                            </div>
                        </div>

                        <div class="template-card" onclick="useTemplate('elegant')">
                            <div class="template-preview elegant-preview">
                                <div class="preview-header">Elegant Gallery</div>
                                <div class="preview-hero">Sophisticated Photography</div>
                                <div class="preview-gallery">
                                    <div class="preview-photo"></div>
                                    <div class="preview-photo"></div>
                                    <div class="preview-photo"></div>
                                </div>
                            </div>
                            <div class="template-info">
                                <h3>Elegant Gallery</h3>
                                <p>Sophisticated serif typography with rich brown and cream color palette</p>
                                <div class="template-features">
                                    <span class="feature-tag">Full-Screen Gallery</span>
                                    <span class="feature-tag">Elegant Typography</span>
                                    <span class="feature-tag">Service Cards</span>
                                    <span class="feature-tag">Social Links</span>
                                </div>
                                <button class="use-template-btn">Use This Template</button>
                            </div>
                        </div>

                        <div class="template-card" onclick="useTemplate('legacy-elite')">
                            <div class="template-preview legacy-elite-preview">
                                <div class="preview-header">The Legacy Photography</div>
                                <div class="preview-hero">Lance Casselman</div>
                                <div class="preview-tagline">Timeless Elegance â€¢ Authentic Moments</div>
                                <div class="preview-gallery">
                                    <div class="preview-photo legacy-photo-1"></div>
                                    <div class="preview-photo legacy-photo-2"></div>
                                    <div class="preview-photo legacy-photo-3"></div>
                                </div>
                            </div>
                            <div class="template-info">
                                <h3>ðŸ”¥ Legacy Elite (Custom For You)</h3>
                                <p>Luxurious dark theme with gold accents, designed specifically for The Legacy Photography's sophisticated brand</p>
                                <div class="template-features">
                                    <span class="feature-tag">ðŸŒŸ Premium Dark Design</span>
                                    <span class="feature-tag">Gold Luxury Accents</span>
                                    <span class="feature-tag">Your Actual Photos</span>
                                    <span class="feature-tag">Brand-Matched</span>
                                </div>
                                <button class="use-template-btn legacy-elite-btn">Use My Custom Template</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Custom Builder Mode -->
                <div id="customBuilderMode" class="custom-builder-mode">
                    <div class="builder-interface">
                        <!-- Left Sidebar - Components & Branding -->
                        <div class="builder-sidebar">
                            <!-- AI-Powered Features -->
                            <div class="ai-section">
                                <h3>ðŸ¤– AI Assistant</h3>
                                <button class="ai-btn" onclick="generateAILayout()">Generate Smart Layout</button>
                                <button class="ai-btn" onclick="optimizeForMobile()">Auto Mobile Optimize</button>
                                <button class="ai-btn" onclick="suggestColors()">Smart Color Palette</button>
                                <button class="ai-btn" onclick="generateContent()">AI Content Writer</button>
                            </div>

                            <!-- Branding Controls -->
                            <div class="branding-section">
                                <h3>ðŸŽ¨ Branding</h3>
                                <div class="branding-control">
                                    <label>Logo Upload:</label>
                                    <input type="file" accept="image/*" onchange="uploadLogo(this)" class="logo-upload">
                                    <div id="logoPreview" class="logo-preview"></div>
                                </div>
                                
                                <div class="branding-control">
                                    <label>Business Name:</label>
                                    <input type="text" id="businessName" placeholder="Your Photography Studio" onchange="updateBusinessName()" class="brand-input">
                                </div>
                                
                                <div class="branding-control">
                                    <label>Primary Font:</label>
                                    <select onchange="changePrimaryFont(this.value)" class="font-select">
                                        <option value="system">System Default</option>
                                        <option value="serif">Elegant Serif</option>
                                        <option value="playfair">Playfair Display</option>
                                        <option value="lora">Lora</option>
                                        <option value="crimson">Crimson Text</option>
                                        <option value="modern">Modern Sans</option>
                                        <option value="montserrat">Montserrat</option>
                                        <option value="opensans">Open Sans</option>
                                        <option value="roboto">Roboto</option>
                                    </select>
                                </div>
                                
                                <div class="branding-control">
                                    <label>Brand Colors:</label>
                                    <div class="color-grid">
                                        <div class="color-input-group">
                                            <label>Primary</label>
                                            <input type="color" value="#667eea" onchange="updateBrandColor('primary', this.value)" class="color-input">
                                        </div>
                                        <div class="color-input-group">
                                            <label>Secondary</label>
                                            <input type="color" value="#764ba2" onchange="updateBrandColor('secondary', this.value)" class="color-input">
                                        </div>
                                        <div class="color-input-group">
                                            <label>Accent</label>
                                            <input type="color" value="#f39c12" onchange="updateBrandColor('accent', this.value)" class="color-input">
                                        </div>
                                        <div class="color-input-group">
                                            <label>Text</label>
                                            <input type="color" value="#333333" onchange="updateBrandColor('text', this.value)" class="color-input">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Component Library -->
                            <div class="component-section">
                                <h3>ðŸ§© Components</h3>
                                <div class="component-grid">
                                    <div class="component-item" draggable="true" data-component="hero">
                                        ðŸ  Hero Section
                                    </div>
                                    <div class="component-item" draggable="true" data-component="gallery">
                                        ðŸ–¼ï¸ Photo Gallery
                                    </div>
                                    <div class="component-item" draggable="true" data-component="about">
                                        About Section
                                    </div>
                                    <div class="component-item" draggable="true" data-component="services">
                                        Services
                                    </div>
                                    <div class="component-item" draggable="true" data-component="testimonials">
                                        Testimonials
                                    </div>
                                    <div class="component-item" draggable="true" data-component="contact">
                                        ðŸ“ž Contact Form
                                    </div>
                                    <div class="component-item" draggable="true" data-component="pricing">
                                        ðŸ’° Pricing Table
                                    </div>
                                    <div class="component-item" draggable="true" data-component="footer">
                                        ðŸ“‹ Footer
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Main Canvas -->
                        <div class="builder-canvas">
                            <!-- Device Preview Controls -->
                            <div class="canvas-controls">
                                <div class="device-controls">
                                    <button class="device-btn active" onclick="setDevicePreview('desktop')">ðŸ’» Desktop</button>
                                    <button class="device-btn" onclick="setDevicePreview('tablet')">ðŸ“± Tablet</button>
                                    <button class="device-btn" onclick="setDevicePreview('mobile')">ðŸ“± Mobile</button>
                                </div>
                            </div>

                            <!-- Website Canvas -->
                            <div class="website-canvas" id="websiteCanvas" ondrop="dropComponent(event)" ondragover="allowDrop(event)">
                                <!-- Smart Guides -->
                                <div class="smart-guides" id="smartGuides"></div>
                                
                                <!-- Website Content -->
                                <div id="websiteContent" class="website-content">
                                    <div class="canvas-placeholder">
                                        <h2>ðŸŽ¨ Revolutionary Website Builder</h2>
                                        <p>Drag components from the sidebar or start with a template</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Right Sidebar - Properties -->
                        <div class="builder-properties">
                            <h3>âš™ï¸ Properties</h3>
                            <div id="propertyPanel" class="property-panel">
                                <div class="no-selection">
                                    <p>Select an element to edit properties</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                        <div class="template-card" data-template="legacy">
                            <div class="template-preview">
                                <div class="template-mockup legacy-mockup">
                                    <div class="mockup-header">The Legacy Photography</div>
                                    <div class="mockup-hero">Capturing Timeless Moments</div>
                                    <div class="mockup-gallery">
                                        <div class="mockup-photo"></div>
                                        <div class="mockup-photo"></div>
                                        <div class="mockup-photo"></div>
                                    </div>
                                </div>
                            </div>
                            <h4>Legacy Style</h4>
                            <p>Dark elegance with gold accents - perfect for luxury photography</p>
                            <button class="btn btn-primary" onclick="selectTemplate('legacy')">
                                Choose Template
                            </button>
                        </div>

                        <div class="template-card" data-template="modern">
                            <div class="template-preview">
                                <div class="template-mockup modern-mockup">
                                    <div class="mockup-header">Studio Photography</div>
                                    <div class="mockup-hero">Modern. Clean. Beautiful.</div>
                                    <div class="mockup-gallery">
                                        <div class="mockup-photo"></div>
                                        <div class="mockup-photo"></div>
                                        <div class="mockup-photo"></div>
                                    </div>
                                </div>
                            </div>
                            <h4>Modern Portfolio</h4>
                            <p>Clean contemporary design with bold typography</p>
                            <button class="btn btn-primary" onclick="selectTemplate('modern')">
                                Choose Template
                            </button>
                        </div>

                        <div class="template-card" data-template="romantic">
                            <div class="template-preview">
                                <div class="template-mockup romantic-mockup">
                                    <div class="mockup-header">Romantic Photography</div>
                                    <div class="mockup-hero">Love Stories Captured</div>
                                    <div class="mockup-gallery">
                                        <div class="mockup-photo"></div>
                                        <div class="mockup-photo"></div>
                                        <div class="mockup-photo"></div>
                                    </div>
                                </div>
                            </div>
                            <h4>Romantic Style</h4>
                            <p>Warm tones and elegant serif fonts for wedding photography</p>
                            <button class="btn btn-primary" onclick="selectTemplate('romantic')">
                                Choose Template
                            </button>
                        </div>

                        <div class="template-card" data-template="bold">
                            <div class="template-preview">
                                <div class="template-mockup bold-mockup">
                                    <div class="mockup-header">BOLD PHOTOGRAPHY</div>
                                    <div class="mockup-hero">DRAMATIC. POWERFUL.</div>
                                    <div class="mockup-gallery">
                                        <div class="mockup-photo"></div>
                                        <div class="mockup-photo"></div>
                                        <div class="mockup-photo"></div>
                                    </div>
                                </div>
                            </div>
                            <h4>Bold & Dramatic</h4>
                            <p>High contrast design for fashion and artistic photography</p>
                            <button class="btn btn-primary" onclick="selectTemplate('bold')">
                                Choose Template
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Website Customization -->
                <div id="websiteCustomization" class="website-customization" style="display: none;">
                    <div class="customization-header">
                        <button class="btn btn-secondary" onclick="backToTemplates()">â† Back to Templates</button>
                        <h3 id="selectedTemplateName">Customizing Template</h3>
                        <div class="customization-actions">
                            <button class="btn btn-secondary" onclick="saveWebsite()">ðŸ’¾ Save</button>
                            <button class="btn btn-primary" onclick="previewWebsite()">ðŸ‘ï¸ Preview</button>
                            <button class="btn btn-success" onclick="publishWebsite()">Publish</button>
                        </div>
                    </div>

                    <div class="customization-layout">
                        <!-- Customization Tabs -->
                        <div class="customization-sidebar">
                            <div class="customization-tabs">
                                <button class="customization-tab active" onclick="showCustomizationSection('content')">
                                    ðŸ“ Content
                                </button>
                                <button class="customization-tab" onclick="showCustomizationSection('design')">
                                    ðŸŽ¨ Design
                                </button>
                                <button class="customization-tab" onclick="showCustomizationSection('photos')">
                                    ðŸ“¸ Photos
                                </button>
                                <button class="customization-tab" onclick="showCustomizationSection('settings')">
                                    âš™ï¸ Settings
                                </button>
                            </div>

                            <!-- Content Customization -->
                            <div id="contentCustomization" class="customization-section active">
                                <h4>Business Information</h4>
                                <div class="form-group">
                                    <label>Business Name</label>
                                    <input type="text" id="businessName" placeholder="Your Photography Business" onchange="updateWebsiteContent()">
                                </div>
                                <div class="form-group">
                                    <label>Tagline</label>
                                    <input type="text" id="tagline" placeholder="Your Professional Tagline" onchange="updateWebsiteContent()">
                                </div>
                                <div class="form-group">
                                    <label>About Text</label>
                                    <textarea id="aboutText" rows="4" placeholder="Tell clients about your photography services..." onchange="updateWebsiteContent()"></textarea>
                                </div>
                                <div class="form-group">
                                    <label>Phone Number</label>
                                    <input type="tel" id="contactPhone" placeholder="(555) 123-4567" onchange="updateWebsiteContent()">
                                </div>
                                <div class="form-group">
                                    <label>Email Address</label>
                                    <input type="email" id="contactEmail" placeholder="your@email.com" onchange="updateWebsiteContent()">
                                </div>
                            </div>

                            <!-- Design Customization -->
                            <div id="designCustomization" class="customization-section">
                                <h4>Colors & Fonts</h4>
                                <div class="form-group">
                                    <label>Primary Color</label>
                                    <input type="color" id="primaryColor" onchange="updateWebsiteDesign()">
                                </div>
                                <div class="form-group">
                                    <label>Background Color</label>
                                    <input type="color" id="backgroundColor" onchange="updateWebsiteDesign()">
                                </div>
                                <div class="form-group">
                                    <label>Text Color</label>
                                    <input type="color" id="textColor" onchange="updateWebsiteDesign()">
                                </div>
                                <div class="form-group">
                                    <label>Font Style</label>
                                    <select id="fontStyle" onchange="updateWebsiteDesign()">
                                        <option value="serif">Serif (Elegant)</option>
                                        <option value="sans-serif">Sans-serif (Modern)</option>
                                        <option value="script">Script (Decorative)</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Photos Customization -->
                            <div id="photosCustomization" class="customization-section">
                                <h4>Portfolio Photos</h4>
                                <div class="form-group">
                                    <label>Upload Photos</label>
                                    <input type="file" id="portfolioPhotos" multiple accept="image/*" onchange="handlePhotoUpload()">
                                    <p class="form-help">Upload your best portfolio photos (recommended: 6-12 images)</p>
                                </div>
                                <div id="photoPreview" class="photo-preview-grid"></div>
                                <div class="form-group">
                                    <label>Gallery Layout</label>
                                    <select id="galleryLayout" onchange="updateGallerySettings()">
                                        <option value="grid">Grid Layout</option>
                                        <option value="masonry">Masonry Layout</option>
                                        <option value="carousel">Carousel Slider</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Settings Customization -->
                            <div id="settingsCustomization" class="customization-section">
                                <h4>Website Settings</h4>
                                <div class="form-group">
                                    <label>Website URL</label>
                                    <input type="text" id="websiteUrl" placeholder="your-website-name" onchange="updateWebsiteSettings()">
                                    <p class="form-help">Will be: your-website-name.replit.app</p>
                                </div>
                                <div class="form-group">
                                    <label>SEO Title</label>
                                    <input type="text" id="seoTitle" placeholder="Professional Photography Services" onchange="updateWebsiteSettings()">
                                </div>
                                <div class="form-group">
                                    <label>SEO Description</label>
                                    <textarea id="seoDescription" rows="3" placeholder="Professional photography services for weddings, portraits, and events..." onchange="updateWebsiteSettings()"></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- Website Preview -->
                        <div class="website-preview-area">
                            <div class="preview-controls">
                                <button class="preview-control active" onclick="setPreviewDevice('desktop')">ðŸ’» Desktop</button>
                                <button class="preview-control" onclick="setPreviewDevice('tablet')">ðŸ“± Tablet</button>
                                <button class="preview-control" onclick="setPreviewDevice('mobile')">ðŸ“± Mobile</button>
                            </div>
                            <div id="websitePreview" class="website-preview-frame desktop">
                                <div class="preview-placeholder">
                                    <h3>Select a template to start building your website</h3>
                                    <p>Your website preview will appear here</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

</body>
</html>
